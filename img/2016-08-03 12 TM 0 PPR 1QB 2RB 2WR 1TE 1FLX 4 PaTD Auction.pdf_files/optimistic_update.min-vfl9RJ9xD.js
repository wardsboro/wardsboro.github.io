define(["require","exports","external/underscore"],function(t,e,r){"use strict";function n(t){return r.isString(t)}var i={},u=function(){function t(t){this._base=t,this._journal=[],this._head=i}return t.prototype.getValue=function(){return this._head===i&&(this._head=this._journal.reduce(function(t,e){return e.patch(t)},this._base)),this._head},t.prototype.commit=function(t){var e=r.uniqueId("optimist-patch-");return this._head=i,this._journal.push({id:e,patch:t}),e},t.prototype.rollback=function(t){return null!==this._removeJournalEntry(t)},t.prototype.rebase=function(t){if(n(t)){var e=this._removeJournalEntry(t);return e?(this._head=i,this._base=e.patch(this._base),!0):!1}return this._head=i,this._base=t(this._base),!0},t.prototype._removeJournalEntry=function(t){var e=r.findIndex(this._journal,function(e){return e.id===t});return 0>e?null:(this._head=i,this._journal.splice(e,1)[0])},t}();e.Optimist=u});
//# sourceMappingURL=optimistic_update.min.js-vfl6DEtSl.map