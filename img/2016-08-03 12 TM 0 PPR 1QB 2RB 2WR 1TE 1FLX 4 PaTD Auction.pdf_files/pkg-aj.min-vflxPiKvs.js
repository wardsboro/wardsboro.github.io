(function(){define("modules/clean/avatar/group_avatar",["external/react","modules/core/user_i18n","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size"],function(e,t,s,n,o){var a,r,i;return r=o.VALID_AVATAR_DIMENSIONS,i=e.createElement,a=e.createClass({displayName:"GroupAvatar",propTypes:{dimension:e.PropTypes.oneOf(r).isRequired,group:e.PropTypes.object.isRequired,optionalClass:e.PropTypes.string},render:function(){var e;return e={dimension:this.props.dimension,photoUrl:this.props.group.is_team_group?"/static/images/icons/team_32-vflk8mBzO.png":void 0,shape:"SQUARE",name:this.props.group.name,optionalClass:this.props.optionalClass,defaultAvatar:i(n,{dimension:this.props.dimension,initials:t.getInitials(this.props.group.name).toUpperCase(),name:this.props.group.name,shape:"SQUARE",optionalClass:this.props.optionalClass})},i(s,e)}})})}).call(this),function(){define("modules/clean/groups/add_group_members_modal",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/groups/group_members_form","modules/clean/viewer"],function(e,t,s,n,o,a,r,i){var l,u,m,c,p,d,h;return m=s._,d=s.ungettext,u=a.Modal,c=t.DOM,p=t.PropTypes,h=i.get_viewer(),l=t.createClass({displayName:"AddGroupMembersModal",propTypes:{group:p.object,onGroupChanged:p.func,isWebActionsAsync:p.bool},getInitialState:function(){return{canProceed:!1,submitting:!1}},componentDidMount:function(){return e(".contacts-tokenizer-input").select()},_canProceed:function(){var e,t;return(null!=(e=this.refs.members)?e.areAllContactsValid():void 0)&&!(null!=(t=this.refs.members)?t.isEmpty():void 0)},onClickAddMembers:function(e){return e.preventDefault(),this.refs.members.getFinalData(function(e){return function(t){var s,a;return a=t.emails,s=e._canProceed(),e.setState({canProceed:s}),s?(e.setState({submitting:!0}),o.WebRequest({url:"/groups_ajax/add_users_to_group",data:{members:JSON.stringify(a),group_id:e.props.group.id},subject_user:h.work_user,complete:function(){return e.isMounted()?e.setState({submitting:!1}):void 0},success:function(t){return t=JSON.parse(t),null===t.data?n.success(d("Member added.","Members added.",a.length)):n.success(d("Adding member...","Adding members...",a.length)),u.close(),e.props.onGroupChanged(!0,null)}})):void 0}}(this))},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return t.createElement(u,{title:m("Add members to “%(group_name)s”").format({group_name:this.props.group.name}),acceptButtonText:m("Add members"),dismissButtonText:m("Cancel"),onAccept:this.onClickAddMembers,acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,ref:"modal"},t.createElement(r,{ref:"members",group:this.props.group,user:h.work_user,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:m("Add names or emails"),disallowGroupMembers:!0}),this.props.isWebActionsAsync?c.label({},c.br({}),m("Giving new members access to all of this group’s shared folders might take a little while.")):void 0)}})})}.call(this),function(){define("modules/clean/groups/change_group_name_modal",["external/react","modules/core/i18n","modules/clean/ajax","modules/clean/react/modal","modules/clean/react/input","modules/clean/viewer","modules/clean/groups/constants"],function(e,t,s,n,o,a,r){var i,l,u,m,c,p,d;return m=t._,u=n.Modal,l=r.MAX_GROUP_NAME_LEN,c=e.DOM,p=e.PropTypes,d=a.get_viewer(),i=e.createClass({mixins:[e.addons.LinkedStateMixin],displayName:"ChangeGroupNameModal",propTypes:{origGroupName:p.string,groupId:p.string,onGroupChanged:p.func},getInitialState:function(){return{newGroupName:"",submitting:!1,errors:null}},groupNameIsValid:function(){return this.state.newGroupName.length<=l},canProceed:function(){return!this.state.submitting&&""!==this.state.newGroupName.trim()&&this.groupNameIsValid()},getLocalError:function(){return this.groupNameIsValid()?void 0:{message_text:m("The group name should be under %(max_len)d characters").format({max_len:l})}},onSubmit:function(e){return null!=e&&e.preventDefault(),this.canProceed()&&!this.state.submitting?(this.setState({submitting:!0}),s.WebRequest({url:"/groups_ajax/rename_group",data:{group_id:this.props.groupId,new_name:this.state.newGroupName},subject_user:d.work_user,error:function(e){return function(t,s,n){return e.setState({submitting:!1,errors:function(){try{return JSON.parse(n)}catch(e){}}()})}}(this),success:function(e){return function(t){return t=JSON.parse(t),u.close(),e.props.onGroupChanged(!0,null)}}(this)})):void 0},render:function(){var t,s;return e.createElement(u,{className:"change-group-name-modal",title:m("Edit ‘%(group_name)s’").format({group_name:this.props.origGroupName}),acceptButtonText:m("Save changes"),dismissButtonText:m("Cancel"),acceptButtonDisabled:!this.canProceed(),submitting:this.state.submitting,onAccept:this.onSubmit,autoClose:!1},c.form({onSubmit:this.onSubmit},c.label({className:"label-description"},m("Group name"),e.createElement(o.text,{className:"group-name-input",placeholder:this.props.origGroupName,valueLink:this.linkState("newGroupName"),autofocus:!0,"error-after":!0,error:this.getLocalError()||(null!=(t=this.state.errors)?t.new_name:void 0)||(null!=(s=this.state.errors)?s.full_name:void 0)}))))}})})}.call(this),function(){define("modules/clean/groups/constants",[],function(){var e,t;return t=140,e=400,{MAX_GROUP_NAME_LEN:t,MAX_GROUP_DESCRIPTION_LEN:e}})}.call(this),function(){define("modules/clean/groups/group_member_list",["external/underscore","external/classnames","external/react","modules/core/i18n","modules/core/user_i18n","modules/core/notify","modules/clean/ajax","modules/clean/viewer","modules/clean/react/table","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/dbox_app_promo","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/groups/simple_modals"],function(e,t,s,n,o,a,r,i,l,u,m,c,p,d,h){var g,f,b,_,v,y,w,C,M,T,N,S,A,k;return v=n._,A=n.ungettext,f=m.BubbleMenu,b=m.BubbleMenuItem,g=c.Actionable,M=h.showLeaveGroupModal,S=h.showRemoveUserModal,N=h.showRemoveOwnerPermissionsModal,T=h.showMakeOwnerModal,w=s.DOM,C=s.PropTypes,k=i.get_viewer(),y=function(e,t){var s,n,o;n={};for(o in e)s=e[o],n[o]=s.bind(t);return n},_=s.createClass({displayName:"MemberList",propTypes:{group:C.object,canHaveAdminUi:C.bool,managedGroupsEnabled:C.bool,onGroupChanged:C.func,isWebActionsAsync:C.bool},viewerIsOwner:function(){return this.props.group.is_owner},canManageGroup:function(){return!this.props.group.is_team_group&&(this.props.canHaveAdminUi||this.viewerIsOwner())},onRemoveUserSuccess:function(e){return this.removeMemberUser(e),this.refs.members.forceRefresh(),this.props.onGroupChanged(!1,this.props.group)},onClickRemoveUser:function(e){return e.user_id===k.work_user.id?M(this.props.group,this.props.isWebActionsAsync):S(this.props.group,e,this.onRemoveUserSuccess.bind(this),this.props.isWebActionsAsync)},onClickApproveJoinReq:function(e){return r.WebRequest({url:"/groups_ajax/approve",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:k.work_user,success:function(t){return function(s){return a.success(v("Request approved.")),t.convertPendingUserToMemberLocally(e),t.refs.members.forceRefresh(),t.props.onGroupChanged(!1,t.props.group)}}(this)})},onClickRemoveJoinReq:function(e){return r.WebRequest({url:"/groups_ajax/remove",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:k.work_user,success:function(t){return function(s){return a.success(v("Request removed.")),t.removePendingUser(e),t.refs.members.forceRefresh()}}(this)})},removeMemberUser:function(t){var s;return s=e.indexOf(this.props.group.users,t),s>-1?(this.props.group.users.splice(s,1),this.props.group.user_count-=1,this.props.group.owners=this.props.group.owners.filter(function(e){return e.email!==t.email})):void 0},removePendingUser:function(t){var s;return s=e.indexOf(this.props.group.pending_req_users,t),s>-1?this.props.group.pending_req_users.splice(s,1):void 0},convertPendingUserToMemberLocally:function(e){return this.removePendingUser(e),e.localized_joined_ts=v("Just now"),e.is_pending=!1,this.props.group.users.unshift(e),this.props.group.user_count+=1},localSortUsers:function(e,t){var s,n,o,a;return a=this.props.group.users.slice(0),n=function(e,t){return e.sort(function(e,s){return e[t]<s[t]?-1:e[t]>s[t]?1:0})},o=e.sortColumn,"localized_joined_ts"===o&&(o="joined_ts"),n(a,o),e.sortDir===l.DESC_DIR&&a.reverse(),s=this.buildMemberList(this.props.group.pending_req_users,a),t(null,{rows:s,total:s.length})},buildMemberList:function(e,t){return this.canManageGroup()?e.concat(t):t},columnTypes:{displayName:function(e){return{field:"name",header:v("Name"),classes:{"display-name-column":!0},width:e,render:function(e){return function(n){return w.span({},s.createElement(p,{dimension:24,photoUrl:n.photo_url,optionalClass:"u-mar-right-s u-mar-left-xs",defaultAvatar:s.createElement(d,{dimension:24,initials:o.getInitials(n.name||n.email),name:n.name,shape:"CIRCLE",optionalClass:"u-mar-right-s u-mar-left-xs"})}),w.span({className:"user-name"},w.span({className:t({pending:n.is_pending})},n.name?n.name:"-")),w.span({className:"user-status"},n.is_owner?e.props.managedGroupsEnabled?" · "+v("Manager"):" · "+v("Owner"):n.is_pending?" · "+v("Pending"):void 0))}}(this)}},userEmail:function(e){return{field:"email",header:v("Email"),classes:{"email-column":!0},width:e,render:function(e){return w.span({className:"user-email"},w.span({className:t({pending:e.is_pending})},e.email))}}},joinedDate:function(e){return{field:"localized_joined_ts",header:v("Joined"),width:e,render:function(e){return e.localized_joined_ts}}},settings:function(e){return{width:e,classes:{"settings-column":!0},render:function(e){return function(t){var n,o,a,r,i;return e.canManageGroup()?t.is_pending?w.span({className:"pending-request-buttons"},s.createElement(g,{handler:e.onClickApproveJoinReq.bind(e,t)},w.button({className:"button-primary button-small action-button approve-join-req-button"},v("Approve"))),w.button({className:"remove-request-button",onClick:e.onClickRemoveJoinReq.bind(e,t)},w.img({src:"/static/images/x-vflYKfRuL.png",alt:v("Remove join request")}))):e.props.group.is_admin_managed?w.button({className:"remove-user-button",onClick:e.onClickRemoveUser.bind(e,t)},w.img({src:"/static/images/x-vflYKfRuL.png",alt:v("Remove user")})):(a=w.button({className:"settings-button"},s.createElement(u,{group:"web",name:"gear",alt:v("Member settings")})),r=[s.createElement(b,{onClick:e.onClickRemoveUser.bind(e,t)},v("Remove user"))],t.is_owner?(i=v(e.props.managedGroupsEnabled?"Remove manager permissions":"Remove owner permissions"),r.push(s.createElement(b,{onClick:N.bind(e,e.props.group,t,e.props.onGroupChanged,e.props.managedGroupsEnabled)},i))):t.can_be_owner&&(e.props.managedGroupsEnabled?(n=v("Make manager"),o=!0):(n=v("Make owner"),o=!1),r.push(s.createElement(b,{onClick:T.bind(e,e.props.group,t,e.props.onGroupChanged,o)},n))),s.createElement(f,{targetButton:a,position:f.POSITIONS.BOTTOM_LEFT,verticalDisplacement:-5,items:r})):""}}(this)}}},componentWillMount:function(){return this.columnTypes=y(this.columnTypes,this)},renderMemberTable:function(){var e;return e=this.buildMemberList(this.props.group.pending_req_users,this.props.group.users),s.createElement(l,{ref:"members",columns:this.canManageGroup?[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(147),this.columnTypes.settings(103)]:[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(250)],initialData:{rows:e,total:e.length},initialSortColumn:0,emptyMessage:v("This group has no members."),rowsPerPage:1e6,onRequestData:this.localSortUsers,classes:{"grey-style":!0}})},render:function(){return w.div({className:"member-list-container"},w.div({className:"group-user-info"},w.div({className:"member-count"},A("%(n)d member","%(n)d members",this.props.group.user_count).format({n:this.props.group.user_count}))),this.renderMemberTable())}})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/group_members_form",["external/underscore","external/classnames","external/react","modules/core/exception","modules/core/i18n","modules/clean/contacts/data","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/react/input"],function(t,s,n,o,a,r,i,l,u){var m,c,p,d,h,g,f,b;return g=o.assert,h=a._,m=r.Contact,p=i.ContactsTokenizer,c=i.ContactTokenState,f=n.DOM,b=n.PropTypes,d=n.createClass({displayName:"GroupMembersForm",propTypes:{group:b.object,user:b.object.isRequired,populatedContacts:b.arrayOf(b.instanceOf(m)),customClass:b.string,onChange:b.func,emailPlaceholder:b.string,messagePlaceholder:b.string,errorMessageSpaceFixed:b.bool,emailCheckerStore:b.object,includeCustomMessage:b.bool,disallowGroupMembers:b.bool,disallowCurrentUser:b.bool},getDefaultProps:function(){return{customClass:"",populatedContacts:[],emailPlaceholder:h("Name or email"),messagePlaceholder:h("Add a message (optional)"),includeCustomMessage:!0,disallowGroupMembers:!1,disallowCurrentUser:!1}},getInitialState:function(){return{errorMessage:null}},componentWillMount:function(){return this.props.populatedContacts.length>0?this._updateErrorMessage():void 0},getContacts:function(){return this.refs.tokenizer.getContacts()},getFinalData:function(e){var s,n,o,a;return this.refs.tokenizer.tokenizeAll(),s=this.getContacts(),this.props.includeCustomMessage&&(n=this.refs.message.getValue()),o=t.filter(s,function(e){return e.type===l.EMAIL}),a=t.map(o,function(e){return{email:e.email,is_owner:!1}}),this._updateErrorMessage(),e({emails:a,custom_message:n})},getGroupEmails:function(){var e;return function(){var t,s,n,o;for(n=this.props.group.users,o=[],t=0,s=n.length;s>t;t++)e=n[t],o.push(e.email);return o}.call(this)},areAllContactsValid:function(){var e;return e=this.refs.tokenizer.serializeInputData().tokens,0===e.length?!0:t.all(e,function(e){return function(t){return e._validateContact(t).state===c.ok}}(this))},isEmpty:function(){var e,t,s;return e=this.refs.tokenizer.serializeInputData(),t=e.tokens,s=e.value,0===t.length&&0===s.length},_validateContact:function(t){var s,n;return n={state:c.ok},t.invalid?n={state:c.invalid,msg:h("One or more names or email addresses you entered are invalid.")}:this.props.disallowGroupMembers&&(s=t.email,e.call(this.getGroupEmails(),s)>=0)?n={state:c.invalid,msg:h("Member already exists in the group.")}:t.on_team||(n={state:c.invalid,msg:h("This person isn’t on your team")}),n},_updateErrorMessage:function(){var e,t,s,n,o,a,r;for(o=this.refs.tokenizer.serializeInputData().tokens,t=0,s=o.length;s>t;t++)if(e=o[t],a=this._validateContact(e),r=a.state,n=a.msg,r!==c.ok)return void this.setState({errorMessage:n});return this.setState({errorMessage:null})},onContentsChange:function(){var e;return this._updateErrorMessage(),"function"==typeof(e=this.props).onChange?e.onChange():void 0},render:function(){var t,o;return t={"add-group-members-form":!0,"u-mar-top-xs":!0,"error-message-fixed":this.props.errorMessageSpaceFixed,"has-custom-message":this.props.includeCustomMessage},this.props.customClass&&(t[this.props.customClass]=!0),o=function(t){return function(s){var n,o;return n=s.type===l.EMAIL&&s.team,t.props.disallowGroupMembers&&(n=n&&(o=s.email,e.call(t.getGroupEmails(),o)<0)),t.props.disallowCurrentUser&&(n=n&&s.email!==t.props.user.email),Boolean(n)}}(this),f.div({className:s(t)},f.div({className:"error-message"},this.state.errorMessage),n.createElement(p,{ref:"tokenizer",user:this.props.user,placeholder:this.props.emailPlaceholder,onContentsChange:this.onContentsChange,autofocus:!0,populatedInputData:{tokens:this.props.populatedContacts,value:""},customContactValidator:this._validateContact,customContactFilter:o}),this.props.includeCustomMessage?n.createElement(u.textarea,{ref:"message",className:"custom-message","disable-errors":!0,"aria-label":"member emails",placeholder:this.props.messagePlaceholder}):void 0)}})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/groups_page",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/css","modules/clean/react/select","modules/clean/react/sprite","modules/clean/react/table","modules/clean/react/modal","modules/clean/avatar/group_avatar","modules/clean/react/tooltip","modules/clean/viewer","modules/clean/groups/create_group_modal","modules/clean/groups/single_group_page","modules/clean/groups/search_input"],function(t,s,n,o,a,r,i,l,u,m,c,p,d,h,g,f){var b,_,v,y,w,C,M,T,N,S,A,k,R,D,x,E,P;return S=n._,w=m.Modal,T=p.Tooltip,N=p.TooltipPosition,k=s.createElement,R=s.DOM,x=s.PropTypes,C=i.input,M=i.option,P=d.get_viewer(),A=function(e,t){var s,n,o;n={};for(o in e)s=e[o],n[o]=s.bind(t);return n},b=s.createClass({displayName:"GroupsList",propTypes:{title:x.string,emptyMessage:x.element,maxRows:x.number,onRequestData:x.func,showJoinReqButtons:x.bool,showPendingCountForOwners:x.bool,canViewGroupDetails:x.bool,teamName:x.string,managedGroupsEnabled:x.bool,insideAdminConsole:x.bool,onTotalGroupsChange:x.func,searchQuery:x.string,canHaveAdminUi:x.bool,enhancedGroupsEnabled:x.bool},columnTypes:{displayName:function(e){return{field:"name",header:S("Name"),classes:{"group-name-column":!0},width:e,render:function(e){return R.span({},k(c,{group:e,dimension:24,optionalClass:"u-mar-right-s u-mar-left-xs"}),R.span({className:"group-name"},e.name))}}},members:function(t){return{field:"user_count",header:S("Members"),width:t,initialSortDir:u.DESC_DIR,render:function(t){return function(s){var n;return t.props.showPendingCountForOwners&&0!==s.join_req_pending_count&&(n=P.work_user.id,e.call(s.owner_user_ids,n)>=0)?s.user_count+" • "+s.join_req_pending_count+" "+S("pending"):s.user_count}}(this)}},owners:function(e){var t;return t=S(this.props.managedGroupsEnabled?"Managed by":"Owned by"),{field:"owners",header:t,classes:{"managed-by-column":!0},width:e,render:function(e){return function(t){return t.is_team_group?R.label({className:"tooltip-label no-manager-label"},S("No manager"),s.createElement(T,{position:N.RIGHT,tooltip_contents:S("This group was created automatically."),tooltip_classname:"no-manager-tooltip-bubble"},R.button({className:"sprite-button"},k(l,{group:"web",name:"info",alt:S("This group was created automatically.")})))):t.is_admin_managed?e.props.teamName:t.owner_user_names.length>0?t.owner_user_names.join(", "):"-"}}(this)}},joinRequests:function(e){return{width:e,classes:{"join-request-column":!0},render:function(e){return function(t){var s;return t.owner_user_ids.length>0&&!t.is_group_member?(s=t.waiting_for_join_req_approval,s?R.div({className:"join-req-pending"},S("Pending")):R.button({className:"button-tertiary button-small action-button join-req-button",onClick:e.onClickJoinReq.bind(e,t),disabled:s},S("Ask to join"))):""}}(this)}}},onClickJoinReq:function(e,t){return t.stopPropagation(),e.waiting_for_join_req_approval=!0,this.forceUpdate(),a.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:e.id},subject_user:P.work_user,success:function(e){return o.success(S("Request sent."))}})},onRowClicked:function(e){return this.props.canViewGroupDetails?this.props.insideAdminConsole?window.location.hash="/"+e.id:e.is_group_member||this.props.canHaveAdminUi?window.location.hash="groups/"+e.id:o.warning(S("Groups can only be viewed by group members")):void 0},componentWillMount:function(){return this.columnTypes=A(this.columnTypes,this)},render:function(){return R.div({className:"groups-list"},this.props.title?R.h1({className:"table-name"},this.props.title):void 0,s.createElement(u,{columns:this.props.showJoinReqButtons?[this.columnTypes.displayName(300),this.columnTypes.members(200),this.columnTypes.owners(200),this.columnTypes.joinRequests(100)]:[this.columnTypes.displayName(300),this.columnTypes.members(200),this.columnTypes.owners(300)],initialSortColumn:1,initialSortDir:u.DESC_DIR,emptyMessage:this.props.emptyMessage,rowsPerPage:this.props.maxRows,classes:{"grey-style":!0,"clickable-rows":this.props.canViewGroupDetails},rowClasses:{"group-row":!0},onRequestData:this.props.onRequestData,onRowClicked:this.onRowClicked,hideHeaderOnEmptyTable:this.props.insideAdminConsole&&!this.props.searchQuery,onTotalUpdated:this.props.onTotalGroupsChange,ref:"GroupsTable"}))},componentDidUpdate:function(e,t){return e.onRequestData!==this.props.onRequestData||e.searchQuery!==this.props.searchQuery?(this.refs.GroupsTable.onChangePage(0),this.refs.GroupsTable.forceRefresh()):void 0}}),E=function(e,t,n){return R.span({className:"group-search"},s.createElement(f,{placeholder:S("Search groups"),onTriggerSearch:e,onEnterSearch:t,onExitSearch:n,onClearSearchQuery:t}))},D=function(e,t,s){return a.WebRequest({url:e,data:t,subject_user:P.work_user,success:function(e){return e=JSON.parse(e),s(null,{rows:e.groups,total:e.total_groups})}})},v=s.createClass({displayName:"GroupsListPage",propTypes:{canHaveAdminUi:x.bool,groupControlledByAdmin:x.bool,managedGroupsEnabled:x.bool,teamName:x.string,isLimitedTeam:x.bool,showSearch:x.bool,enhancedGroupsEnabled:x.bool},getInitialState:function(){return{searchQuery:null,tablesVisible:!0}},getMyGroupsData:function(e,t){var s,n;return n="/groups_ajax/get_groups_for_user_paginated",s={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir},D(n,s,t)},getOtherGroupsData:function(e,t){var s,n;return n="/groups_ajax/get_groups_for_team_paginated",s={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,exclude_actors_groups:!0},D(n,s,t)},getSearchGroupsResults:function(e,t){var s,n;return n="/groups_ajax/get_groups_for_team_paginated",s={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!1,search_query:this.state.searchQuery},D(n,s,t)},onCreateClicked:function(){return w.showInstance(s.createElement(h,{managedGroupsEnabled:this.props.managedGroupsEnabled&&!this.props.isLimitedTeam,canHaveAdminUi:this.props.canHaveAdminUi,insideAdminConsole:!1,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled}))},onTriggerSearch:function(e){return this.setState({searchQuery:e,tablesVisible:!0})},onExitSearch:function(){return this.setState({searchQuery:null,tablesVisible:!0})},hideTable:function(){return this.setState({tablesVisible:!1})},render:function(){return R.div({className:"groups-page"},R.div({className:"page-heading-buttons"},this.props.showSearch?E(this.onTriggerSearch,this.hideTable,this.onExitSearch):void 0,this.props.canHaveAdminUi||!this.props.groupControlledByAdmin?R.button({className:"button-primary action-button create-group-button",onClick:this.onCreateClicked},S("Create Group")):void 0),this.renderMyGroupsList(),this.renderMoreGroupsList(),this.renderSearchGroupsList())},renderMyGroupsList:function(){return this.state.tablesVisible&&null===this.state.searchQuery?R.div({className:"my-groups-list"},s.createElement(b,{title:S("My groups"),emptyMessage:R.span({},S("You’re not a member of any groups yet. To join one, select the group name and then click the "),R.b({},S("Ask to join button")),".",R.br(),S("You can also start a new group by clicking "),R.b({},S("Create group")),S(".")),maxRows:5,onRequestData:this.getMyGroupsData,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,managedGroupsEnabled:this.props.managedGroupsEnabled,insideAdminConsole:!1,canHaveAdminUi:this.props.canHaveAdminUi,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled})):void 0},renderMoreGroupsList:function(){return this.state.tablesVisible&&null===this.state.searchQuery?R.div({className:"more-groups-list"},s.createElement(b,{title:S("More groups"),emptyMessage:R.span({},S("There are no groups for you to join. You can start a new group by clicking "),R.b({},S("Create group")),S(".")),maxRows:10,onRequestData:this.getOtherGroupsData,showJoinReqButtons:!0,showPendingCountForOwners:!1,canViewGroupDetails:this.props.canHaveAdminUi,teamName:this.props.teamName,managedGroupsEnabled:this.props.managedGroupsEnabled,insideAdminConsole:!1,canHaveAdminUi:this.props.canHaveAdminUi,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled})):void 0},renderSearchGroupsList:function(){return this.state.tablesVisible&&null!==this.state.searchQuery?R.div({className:"more-groups-list"},s.createElement(b,{title:S("Groups"),emptyMessage:R.div({className:"empty-groups-search-results"},S("No groups found")),maxRows:15,onRequestData:this.getSearchGroupsResults,showJoinReqButtons:!0,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,managedGroupsEnabled:this.props.managedGroupsEnabled,insideAdminConsole:!1,searchQuery:this.state.searchQuery,canHaveAdminUi:this.props.canHaveAdminUi})):void 0}}),_=s.createClass({displayName:"GroupsListForAdminsPage",propTypes:{teamName:x.string,enhancedGroupsEnabled:x.bool},getInitialState:function(){return{filterValue:"all_groups",hasGroups:!1,searchQuery:null,tableVisible:!0}},getGroupsData:function(e,t){return a.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!1,search_query:this.state.searchQuery},subject_user:P.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},getCompanyManagedGroupsData:function(e,t){return a.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!0,search_query:this.state.searchQuery},subject_user:P.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},onCreateClicked:function(){return w.showInstance(s.createElement(h,{managedGroupsEnabled:!0,canHaveAdminUi:!0,insideAdminConsole:!0,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled}))},render:function(){return R.div({className:"groups-page"},R.div({className:"page-heading-buttons"},R.button({className:"button-primary action-button create-group-button",onClick:this.onCreateClicked},S("Create Group")),this.renderFindPanel()),this.renderGroupsList())},renderFindPanel:function(){return this.state.hasGroups>0||"company_managed_groups"===this.state.filterValue||null!==this.state.searchQuery?R.span({className:"group-find-panel"},E(this.onTriggerSearch,this.hideTable,this.onExitSearch),R.span({className:"groups-filter"},R.span({className:"label"},S("Show")),s.createElement(C,{name:"filter-select-input",onChange:this.onUserFilterChange,"disable-errors":!0,value:this.state.filterValue},s.createElement(M,{value:"all_groups",key:"all_groups",id:"option-all-groups"},R.span({className:"text"},S("All groups"))),s.createElement(M,{value:"company_managed_groups",key:"company_managed_groups",id:"option-company-managed-groups"},R.span({className:"text"},S("Company-managed groups")))))):void 0},renderGroupsList:function(){var e,t;if(this.state.tableVisible)return t="all_groups"===this.state.filterValue?this.getGroupsData:this.getCompanyManagedGroupsData,e=this.getEmptyMessage(),R.div({className:"more-groups-list"},s.createElement(b,{title:null,emptyMessage:e,maxRows:15,onRequestData:t,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,managedGroupsEnabled:!0,insideAdminConsole:!0,onTotalGroupsChange:this.onTotalGroupsChange,searchQuery:this.state.searchQuery,canHaveAdminUi:!0,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled}))},getEmptyMessage:function(){return"all_groups"===this.state.filterValue?null===this.state.searchQuery?R.span({className:"admin-console-empty-message"},R.div({className:"empty-groups-illustration"},R.img({className:"empty-groups-image",src:"/static/images/groups/groups_empty_illustration-vflibL0ss.svg"})),R.div({className:"empty-groups-view-header"},S("You don’t have any groups yet.")),R.div({className:"empty-groups-desc"},S("Groups make it easier to share with common lists of people in your team."))):R.div({className:"empty-groups-search-results"},S("No groups found")):null===this.state.searchQuery?R.span({},S("You don’t have any company-managed groups currently. "),R.a({href:"/help/7232",target:"_blank"},S("Learn more")),S(" about company-managed groups.")):R.div({className:"empty-groups-search-results"},S("No company-managed groups found"))},onUserFilterChange:function(e,t){return this.setState({filterValue:t})},onTotalGroupsChange:function(e){return this.setState({hasGroups:e>0})},onTriggerSearch:function(e){return this.setState({searchQuery:e,tableVisible:!0})},onExitSearch:function(){return this.setState({searchQuery:null,tableVisible:!0})},hideTable:function(){return this.setState({tableVisible:!1})}}),y=s.createClass({displayName:"GroupsPageContainer",propTypes:{canHaveAdminUi:x.bool,groupControlledByAdmin:x.bool,managedGroupsEnabled:x.bool,teamName:x.string,isLimitedTeam:x.bool,insideAdminConsole:x.bool,isWebActionsAsync:x.bool,showSearch:x.bool,enhancedGroupsEnabled:x.bool},getInitialState:function(){return{viewingGroupId:this.groupIdFromHash()}},componentWillMount:function(){return t(window).on("hashchange",function(e){return function(){return e.setState({viewingGroupId:e.groupIdFromHash()})}}(this))},groupIdFromHash:function(){var e,s,n,o;return s=null!=(o=window.location.hash)?o.split("#").pop():void 0,t("#sharing-tabs").length>0||this.props.insideAdminConsole?(n=null!=s?s.split("/"):void 0,e=null!=n?n[1]:void 0):e=s,null!=e&&""!==e?e:void 0},render:function(){return r.require_css("/static/css/groups/react_groups-vflUKE-qS.css"),r.require_css("/static/css/react/table-vfl33k2n5.css"),null!=this.state.viewingGroupId?"newgroup"===this.state.viewingGroupId?s.createElement(h,{managedGroupsEnabled:this.props.managedGroupsEnabled&&!this.props.isLimitedTeam,canHaveAdminUi:this.props.canHaveAdminUi,insideAdminConsole:this.props.insideAdminConsole,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled}):s.createElement(g,{groupId:this.state.viewingGroupId,canHaveAdminUi:this.props.canHaveAdminUi,managedGroupsEnabled:this.props.managedGroupsEnabled,teamName:this.props.teamName,groupControlledByAdmin:this.props.groupControlledByAdmin,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:this.props.insideAdminConsole,isWebActionsAsync:this.props.isWebActionsAsync,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled}):this.props.insideAdminConsole?s.createElement(_,{teamName:this.props.teamName,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled}):s.createElement(v,{canHaveAdminUi:this.props.canHaveAdminUi,groupControlledByAdmin:this.props.groupControlledByAdmin,managedGroupsEnabled:this.props.managedGroupsEnabled,teamName:this.props.teamName,isLimitedTeam:this.props.isLimitedTeam,showSearch:this.props.showSearch,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled})}})})}.call(this),function(){define("modules/clean/groups/search_input",["external/react","modules/core/notify","modules/core/user_i18n","modules/clean/ajax","modules/clean/css","modules/clean/react/input"],function(e,t,s,n,o,a){var r,i;return i=e.PropTypes,r=e.createClass({displayName:"SearchInput",propTypes:{placeholder:i.string,onTriggerSearch:i.func,onEnterSearch:i.func,onExitSearch:i.func,onClearSearchQuery:i.func},render:function(){return o.require_css("/static/css/components/input-vflu6Lzih.css"),e.createElement(a.text,{ref:"searchInput",name:"search-input",onChange:this.onUserTextChange,onFocus:this.onUserInputFocus,onCloseClick:this.onUserInputClose,placeholder:this.props.placeholder,expandable:!0,expandedWidthOffset:0,animationDuration:0,"disable-errors":!0
})},onUserTextChange:function(e){var t,s;return s=e.target.value,window.clearTimeout(this.searchTimeout),s.trim().length>0?this.searchTimeout=window.setTimeout(function(e){return function(){return e.props.onTriggerSearch(s)}}(this),500):"function"==typeof(t=this.props).onClearSearchQuery?t.onClearSearchQuery():void 0},onUserInputFocus:function(e){var t,s;return s=e.target.value,0===s.trim().length&&"function"==typeof(t=this.props).onEnterSearch?t.onEnterSearch():void 0},onUserInputClose:function(e){var t;return this.refs.searchInput.setValue(""),window.clearTimeout(this.searchTimeout),"function"==typeof(t=this.props).onExitSearch?t.onExitSearch():void 0}})})}.call(this),function(){define("modules/clean/groups/simple_modals",["external/react","external/purify","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/viewer","modules/clean/react/modal"],function(e,t,s,n,o,a,r){var i,l,u,m,c,p,d,h,g;return l=s._,i=r.SimpleModal,g=a.get_viewer(),u=function(e,s){var a;return a=s?l("Deleting “%(group_name)s” will cause all of its members to lose access to folders that have been shared with the group. You will not be able to undo this. <br/><br/>It might take a little while for deleted groups to be removed from all their shared folders.<br/><br/> Are you sure you want to delete the group?").format({group_name:e.name}):l("Deleting “%(group_name)s” will cause all of its members to lose access to folders that have been shared with the group. You will not be able to undo this. <br/><br/>Are you sure you want to delete the group?").format({group_name:e.name}),i.show({title_text:l("Delete “%(group_name)s”?").format({group_name:e.name}),body_html:t.sanitize(a),confirm_text:l("Delete"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/remove_group",data:{group_id:e.id},subject_user:g.work_user,success:function(e){return e=JSON.parse(e),null===e.data?n.success(l("Deleted group.")):n.success(l("Deleting group...")),window.location.hash="groups"}})}})},m=function(e,s){var a;return a=s?l("Leaving “%(group_name)s” will cause you to lose access to folders that have been shared with the group.<br/><br/> It might take a litle while to remove you from all of the group’s shared folders.<br/><br/> Are you sure you want to leave the group?").format({group_name:e.name}):l("Leaving “%(group_name)s” will cause you to lose access to folders that have been shared with the group.<br/><br/> Are you sure you want to leave the group?").format({group_name:e.name}),i.show({title_text:l("Leave “%(group_name)s”?").format({group_name:e.name}),body_html:t.sanitize(a),confirm_text:l("Leave"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/remove_user_from_group",data:{group_id:e.id,user_id:g.work_user.id},subject_user:g.work_user,success:function(e){return e=JSON.parse(e),null===e.data?n.success(l("Left group.")):n.success(l("Leaving group...")),window.location.hash="groups"}})}})},d=function(e,s,a,r){var u;return u=r?l("Removing %(name)s will cause them to lose access to folders that have been shared with the group.<br/><br/> It might take a little while to remove members from all of this group’s shared folders.<br/><br/> Are you sure you want to do this?").format({name:s.name}):l("Removing %(name)s will cause them to lose access to folders that have been shared with the group.<br/><br/> Are you sure you want to do this?").format({name:s.name}),i.show({title_text:l("Remove %(name)s?").format({name:s.name}),body_html:t.sanitize(u),confirm_text:l("Remove"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/remove_user_from_group",data:{group_id:e.id,user_id:s.user_id},subject_user:g.work_user,success:function(e){return e=JSON.parse(e),null===e.data?n.success(l("Member removed.")):n.success(l("Removing member...")),"function"==typeof a?a(s):void 0}})}})},p=function(e,s,n,a){var r,u,m;return a?(m=l("Remove manager permissions from %(name)s?").format({name:s.name}),u=l("Remove manager permissions"),r=l("%(name)s will no longer be able to add and remove managers, change group information, or delete the group.").format({name:s.name})):(m=l("Are you sure you want to remove owner permissions from %(name)s?").format({name:s.name}),u=l("Remove owner permissions"),r=l("%(name)s will no longer be able to add and remove owners or change group information.<br/><strong>%(name)s will also no longer be able to delete the group.</strong>").format({name:s.name})),i.show({title_text:m,body_html:t.sanitize(r),confirm_text:u,confirm_callback:function(t){return function(){return o.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:s.user_id,is_owner:!1},subject_user:g.work_user,error:function(e,s,n){return t.setState({submitting:!1,errors:function(){try{return JSON.parse(n)}catch(e){}}()})},success:function(t){return s.is_owner=!1,e.owners=e.owners.filter(function(e){return e.email!==s.email}),s.user_id===g.work_user.id&&(e.is_owner=!1),n(!1,e)}})}}(this)})},c=function(e,s,n,a){var r,u,m;return a?(m=l("Make %(name)s a manager?").format({name:s.name}),u=l("Make manager"),r=l("%(name)s will be able to add and remove managers, and change group information. <br/>%(name)s will also be able to delete the group.").format({name:s.name})):(m=l("Are you sure you want to make %(name)s an owner?").format({name:s.name}),u=l("Make owner"),r=l("%(name)s will be able to add and remove owners, and change group information.<br/><strong>%(name)s will also be able to delete the group.</strong>").format({name:s.name})),i.show({title_text:m,body_html:t.sanitize(r),confirm_text:u,confirm_callback:function(t){return function(){return o.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:s.user_id,is_owner:!0},subject_user:g.work_user,error:function(e,s,n){return t.setState({submitting:!1,errors:function(){try{return JSON.parse(n)}catch(e){}}()})},success:function(t){var o;return s.is_owner=!0,o={name:s.name,email:s.email},e.owners.push(o),n(!1,e)}})}}(this)})},h=function(e,s){return i.show({title_text:l("Make company-managed?"),body_html:t.sanitize(l("This will become a company-managed group, and admins will be responsible for adding and removing members.")),confirm_text:l("Make company-managed"),cancel_text:l("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/change_to_admin_managed_type",data:{group_id:e.id},subject_user:g.work_user,success:function(t){return n.success(l("%(group_name)s is now company-managed").format({group_name:e.name})),s()}})}})},{showDeleteGroupModal:u,showLeaveGroupModal:m,showRemoveUserModal:d,showRemoveOwnerPermissionsModal:p,showMakeOwnerModal:c,showSwitchToAdminManagedGroupModal:h}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/single_group_page",["external/react","modules/core/i18n","modules/core/notify","modules/core/user_i18n","modules/clean/ajax","modules/clean/css","modules/clean/react/modal","modules/clean/react/button","modules/clean/avatar/group_avatar","modules/clean/react/image","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/dbox_app_promo","modules/clean/viewer","modules/clean/static_urls","modules/clean/groups/change_group_description_modal","modules/clean/groups/change_group_name_modal","modules/clean/groups/add_group_members_modal","modules/clean/groups/group_member_list","modules/clean/groups/simple_modals","modules/clean/groups/switch_to_member_managed_group_modal"],function(t,s,n,o,a,r,i,l,u,m,c,p,d,h,g,f,b,_,v,y,w){var C,M,T,N,S,A,k,R,D,x,E,P,I,L,O;return k=s._,N=i.Modal,M=p.BubbleMenu,T=p.BubbleMenuItem,C=d.Actionable,L=g.static_url,P=y.showLeaveGroupModal,E=y.showDeleteGroupModal,I=y.showSwitchToAdminManagedGroupModal,D=t.DOM,x=t.PropTypes,R=t.createElement,O=h.get_viewer(),S=t.createClass({displayName:"SingleGroupHeader",propTypes:{group:x.object,canHaveAdminUi:x.bool,managedGroupsEnabled:x.bool,teamName:x.string,onGroupChanged:x.func,groupControlledByAdmin:x.bool,isLimitedTeam:x.bool,insideAdminConsole:x.bool,isWebActionsAsync:x.bool,enhancedGroupsEnabled:x.bool},getInitialState:function(){return{showDropdown:!1,requestPending:this.viewerHasPendingJoinReq()}},viewerIsOwner:function(){return this.props.group.is_owner},viewerIsMember:function(){var e,t,s,n;for(s=this.props.group.users,e=0,t=s.length;t>e;e++)if(n=s[e],n.user_id===O.work_user.id)return!0;return!1},viewerHasPendingJoinReq:function(){var e,t,s,n;for(s=this.props.group.pending_req_users,e=0,t=s.length;t>e;e++)if(n=s[e],n.user_id===O.work_user.id)return!0;return!1},onClickJoinReq:function(){return a.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:this.props.group.id},subject_user:O.work_user,success:function(e){return function(t){return n.success(k("Request sent.")),e.setState({requestPending:!0})}}(this)})},showChangeNameModal:function(){return N.showInstance(t.createElement(b,{origGroupName:this.props.group.name,groupId:this.props.group.id,onGroupChanged:this.props.onGroupChanged}))},showChangeDescriptionModal:function(){return N.showInstance(t.createElement(f,{origGroupDescription:this.props.group.description,groupId:this.props.group.id,onGroupChanged:this.props.onGroupChanged}))},showAddMembersModal:function(){return N.showInstance(t.createElement(_,{group:this.props.group,onGroupChanged:this.props.onGroupChanged,isWebActionsAsync:this.props.isWebActionsAsync}))},renderBackToGroups:function(){var e;return e=this.props.insideAdminConsole?"#/":"#groups",D.a({className:"back-to-groups-link",href:e},D.span({className:"back-arrow"},t.createElement(m,{src:L("/static/images/groups/back-vflek6neR.png"),srcHiRes:L("/static/images/groups/back@2x-vflsptBUj.png")})),k("Back to Groups"))},renderGroupInfo:function(){var e,t,s,n,o,a,r,i,l;if(this.props.group.is_team_group)e=k("This group was created automatically. To change who’s in the group, admins can add or remove members of %(team_name)s").format({team_name:this.props.teamName});else{if(this.props.group.is_admin_managed)r=this.props.teamName;else if(this.props.group.owners.length>0){for(a=[],i=this.props.group.owners,t=0,s=i.length;s>t;t++)n=i[t],a.push(n.name);r=a.join(", ")}else r="-";o=k(this.props.managedGroupsEnabled?"Managed by ":"Owned by "),e=o+r}return l=this.props.canHaveAdminUi||this.viewerIsOwner(),D.div({className:"current-location"},D.span({className:"group-info-container"},R(u,{group:this.props.group,dimension:48,optionalClass:"u-mar-right-s"})),D.span({className:"group-info"},D.span({className:"group-name-container"},D.span({className:"group-name"},this.props.group.name),!this.props.group.is_team_group&&l?D.button({className:"group-change-name-link",onClick:this.showChangeNameModal},k("Change")):void 0),D.span({className:"group-managers"},e)),this.props.enhancedGroupsEnabled?this.renderDescription(l):void 0)},renderDescription:function(e){var t,s;return s=this.props.group.description,t=k(Boolean(s)?"Change":"Add description"),D.div({className:"group-description"},D.div({className:"group-description-text"},s),e?D.button({className:"group-change-description-link",onClick:this.showChangeDescriptionModal},t):void 0)},renderGroupActionsButton:function(){var e,s;return e=t.createElement(l.button,{className:"group-actions-button",importance:"secondary"},t.createElement(c,{group:"web",name:"more",alt:k("More actions")})),s=this.viewerIsMember()?[R(T,{onClick:P.bind(this,this.props.group,this.props.isWebActionsAsync)},k("Leave group")),R(T,{onClick:E.bind(this,this.props.group,this.props.isWebActionsAsync)},k("Delete group"))]:[R(T,{onClick:E.bind(this,this.props.group,this.props.isWebActionsAsync)},k("Delete group"))],this.props.managedGroupsEnabled&&this.props.canHaveAdminUi&&!this.props.isLimitedTeam&&(this.props.group.is_admin_managed?s.splice(0,0,R(T,{onClick:this.showSwitchToMemberManagedGroupModal},k("Make user-managed"))):s.splice(0,0,R(T,{onClick:I.bind(this,this.props.group,this.onAdminManaged)},k("Make company-managed")))),t.createElement(M,{position:M.POSITIONS.BOTTOM_LEFT,targetButton:e,items:s,verticalDisplacement:-3})},onAdminManaged:function(){return this.props.onGroupChanged(!0,null)},onMemberManaged:function(t){var s,n,o,a,r,i,l,u;for(r=0,this.props.group.is_admin_managed=!1,this.props.group.owners=[],i=this.props.group.users,n=0,o=i.length;o>n;n++)u=i[n],l=u.email,e.call(t,l)>=0&&(u.is_owner=!0,this.props.group.owners.push(u),r+=1);return a=t.length,s=a>r,this.props.onGroupChanged(s,this.props.group)},showSwitchToMemberManagedGroupModal:function(){return N.showInstance(t.createElement(w,{group:this.props.group,onMemberManaged:this.onMemberManaged}))},renderOwnerButtons:function(){return D.span({className:"group-admin-controls"},t.createElement(l.button,{className:"add-members-button",importance:"primary",onClick:this.showAddMembersModal},k("Add members")),this.renderGroupActionsButton())},renderNonOwnerMemberButtons:function(){return t.createElement(l.button,{className:"leave-group-button",importance:"tertiary",onClick:P.bind(this,this.props.group,this.props.isWebActionsAsync)},k("Leave group"))},renderNonMemberButtons:function(){return this.props.group.owners.length>0?this.state.requestPending?t.createElement(l.button,{className:"ask-to-join-button",importance:"tertiary",disabled:!0},k("Pending")):t.createElement(C,{handler:this.onClickJoinReq},t.createElement(l.button,{className:"ask-to-join-button",importance:"tertiary"},k("Ask to join"))):void 0},render:function(){return D.div({className:"single-group-header"},D.div({className:"group-header"},this.renderBackToGroups(),this.renderGroupInfo()),D.div({className:"group-control-buttons"},this.props.group.is_team_group?void 0:this.props.canHaveAdminUi?this.renderOwnerButtons():this.props.group.is_admin_managed?void 0:this.viewerIsOwner()?this.renderOwnerButtons():this.viewerIsMember()?this.props.groupControlledByAdmin?void 0:this.renderNonOwnerMemberButtons():this.renderNonMemberButtons()))}}),A=t.createClass({displayName:"SingleGroupPage",propTypes:{groupId:x.string,canHaveAdminUi:x.bool,managedGroupsEnabled:x.bool,teamName:x.string,groupControlledByAdmin:x.bool,isLimitedTeam:x.bool,insideAdminConsole:x.bool,isWebActionsAsync:x.bool,enhancedGroupsEnabled:x.bool},getInitialState:function(){return{group:void 0}},componentWillMount:function(){return this.fetchGroup()},fetchGroup:function(){return this.setState({loading:!0}),a.WebRequest({url:"/groups_ajax/get_group_info",data:{group_id:this.props.groupId},subject_user:O.work_user,success:function(e){return function(t){return e.isMounted()?(t=JSON.parse(t),e.setState({group:t.data,loading:!1})):void 0}}(this)})},renderSpinner:function(){return D.div({className:"groups-spinner"},t.createElement(m,{src:L("/static/images/icons/ajax-loading-small-blue-vflm7vRcz.gif"),srcHiRes:L("/static/images/icons/ajax-loading-small-blue@2x-vfljkfH6D.gif"),alt:k("Loading")}))},onGroupChanged:function(e,t){return e?this.fetchGroup():this.setState({group:t})},render:function(){return this.state.loading?this.renderSpinner():(r.require_css("/static/css/react/contacts_tokenizer-vflR5K70C.css"),D.div({className:"single-group-view"},t.createElement(S,{group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,managedGroupsEnabled:this.props.managedGroupsEnabled,teamName:this.props.teamName,onGroupChanged:this.onGroupChanged,groupControlledByAdmin:this.props.groupControlledByAdmin,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:this.props.insideAdminConsole,isWebActionsAsync:this.props.isWebActionsAsync,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled}),t.createElement(v,{group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,managedGroupsEnabled:this.props.managedGroupsEnabled,onGroupChanged:this.onGroupChanged,isWebActionsAsync:this.props.isWebActionsAsync})))}})})}.call(this),function(){define("modules/clean/groups/switch_to_member_managed_group_modal",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/groups/group_members_form","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,n,o,a,r,i){var l,u,m,c,p,d;return m=s._,l=r.Modal,c=t.DOM,p=t.PropTypes,d=i.get_viewer(),u=t.createClass({displayName:"SwitchToMemberManagedGroupModal",propTypes:{group:p.object,onMemberManaged:p.func},getInitialState:function(){return{canProceed:!0,submitting:!1}},componentDidMount:function(){return e(".contacts-tokenizer-input").select()},_canProceed:function(){var e;return null!=(e=this.refs.members)?e.areAllContactsValid():void 0},onSubmit:function(e){return e.preventDefault(),this.refs.members.getFinalData(function(e){return function(t){var s,a,r,i;return a=t.emails,s=e._canProceed(),e.setState({canProceed:s}),s?(e.setState({submitting:!0}),r=e.props.group.name,i=e.props.onMemberManaged,o.WebRequest({url:"/groups_ajax/change_to_member_managed_type",data:{new_owners:JSON.stringify(a),group_id:e.props.group.id},subject_user:d.work_user,complete:function(){return e.isMounted()?e.setState({submitting:!1}):void 0},success:function(e){var t,s;return n.success(m("%(group_name)s is now user-managed").format({group_name:r})),l.close(),s=function(){var e,s,n;for(n=[],e=0,s=a.length;s>e;e++)t=a[e],n.push(t.email);return n}(),i(s)}})):void 0}}(this))},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return t.createElement(l,{title:m("Make user-managed?"),acceptButtonText:m("Make user-managed"),dismissButtonText:m("Cancel"),acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,onAccept:this.onSubmit,ref:"modal"},c.label({className:"label-description"},m("This will become a user-managed group, and the person you choose below will be responsible for approving new members. Group members can leave whenever they like.")),c.br({}),c.br({}),c.label({className:"label-description-secondary"},m("Who should manage this group?")),t.createElement(a,{ref:"members",group:this.props.group,user:d.work_user,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:m("Name or email address"),disallowGroupMembers:!1}))}})})}.call(this),function(){define("modules/clean/react/paginator",["external/classnames","external/react","external/underscore","modules/core/i18n"],function(e,t,s,n){var o,a,r,i;return a=n._,r=t.DOM,o=t.createClass({displayName:"PaginatorPageButton",propTypes:{enabled:t.PropTypes.bool,active:t.PropTypes.bool,onClick:t.PropTypes.func},render:function(){var t;return r.li({onClick:this.props.onClick},this.props.enabled?(t={"pagination-link":!0,active:this.props.active},r.a({href:"#",className:e(t)},this.props.children)):r.span({className:"pagination-link disabled"},this.props.children))},getDefaultProps:function(){return{enabled:!0,active:!0,onClick:function(){}}}}),i=t.createClass({displayName:"Paginator",propTypes:{max_visible_pages:t.PropTypes.number,onChangePage:t.PropTypes.func,num_pages:t.PropTypes.number},render:function(){var e,s,n;return s=r.span({className:"arrow arrow-left"},a("Previous")),n=r.span({className:"arrow arrow-right"},a("Next")),r.div({className:"nav nav-inline"},r.ol({className:"pagination"},this.need_arrows()?t.createElement(o,{enabled:this.left_button_enabled(),onClick:this.left_clicked},s):void 0,function(){var s,n,a,r;for(a=this.current_visible_pages(),r=[],s=0,n=a.length;n>s;s++)e=a[s],r.push(t.createElement(o,{active:e===this.state.active_page,onClick:this.page_clicked.bind(this,e),key:e},""+(e+1)));return r}.call(this),this.need_arrows()?t.createElement(o,{enabled:this.right_button_enabled(),onClick:this.right_clicked},n):void 0))},getInitialState:function(){return{first_page:0,active_page:0}},getDefaultProps:function(){return{max_visible_pages:9,onChangePage:function(){},num_pages:1}},need_arrows:function(){return this.props.num_pages>this.props.max_visible_pages},left_button_enabled:function(){return this.need_arrows()&&this.state.active_page>0},right_button_enabled:function(){return this.need_arrows()&&this.state.active_page<this.props.num_pages-1},current_visible_pages:function(){var e,t,n;return n=this.state.first_page,e=s.min([this.props.num_pages,this.state.first_page+this.props.max_visible_pages]),function(){t=[];for(var s=n;e>=n?e>s:s>e;e>=n?s++:s--)t.push(s);return t}.apply(this)},ensure_in_range:function(e,t,s){return Math.max(t,Math.min(s,e))},setActivePage:function(e){var t,s;e=this.ensure_in_range(e,0,this.props.num_pages-1),t=e-Math.floor(this.props.max_visible_pages/2),t=this.ensure_in_range(t,0,this.props.num_pages-this.props.max_visible_pages),s=t+this.props.max_visible_pages,e!==this.state.active_page&&this.props.onChangePage(e),this.setState({first_page:t,last_page:s,active_page:e})},left_clicked:function(e){return e.preventDefault(),this.setActivePage(this.state.active_page-1)},right_clicked:function(e){return e.preventDefault(),this.setActivePage(this.state.active_page+1)},page_clicked:function(e,t){return t.preventDefault(),this.setActivePage(e)}})})}.call(this),function(){var e=[].slice;define("modules/clean/react/table",["external/classnames","external/react","jquery","external/lru","modules/core/i18n","modules/clean/react/paginator"],function(t,s,n,o,a,r){var i,l,u,m,c,p,d,h;return c=a._,d=s.DOM,h=s.PropTypes,p=function(){var s;return s=1<=arguments.length?e.call(arguments,0):[],t(n.extend.apply(n,[{}].concat(e.call(s))))},i=1,l=-1,m="—",u=s.createClass({displayName:"Table",propTypes:{columns:h.arrayOf(h.shape({field:h.string,header:h.node,width:h.oneOfType([h.number,h.string]),sortable:h.bool,initialSortDir:h.number,classes:h.object,render:h.func})),onRequestData:h.func,onTotalUpdated:h.func,initialData:h.shape({total:h.number,rows:h.array}),emptyMessage:h.node,classes:h.object,headerClasses:h.object,bodyClasses:h.object,rowClasses:h.oneOfType([h.object,h.func]),cellClasses:h.object,initialSortColumn:h.number,initialSortDir:h.number,rowsPerPage:h.number,loadingIndicator:h.string,onRowClicked:h.func,hideHeaderOnEmptyTable:h.bool},statics:{ASC_DIR:i,DESC_DIR:l},getDefaultProps:function(){return{initialSortColumn:0,initialSortDir:i,rowsPerPage:10,hideHeaderOnEmptyTable:!1}},getInitialState:function(){var e,t,s,n;return{total:null!=(e=null!=(t=this.props.initialData)?t.total:void 0)?e:0,rows:null!=(s=null!=(n=this.props.initialData)?n.rows:void 0)?s:[],currentPage:0,sortColumn:this.props.initialSortColumn,sortDir:this.props.initialSortDir}},componentWillMount:function(){var e;return this.cache=new o(1e3),(null!=(e=this.props.initialData)?e.rows:void 0)?void 0:this.refreshData()},forceRefresh:function(){return this.cache.removeAll(),this.refreshData()},refreshData:function(){var e,t,s,n,o;return this.setState({loading:!0}),n={offset:this.state.currentPage*this.props.rowsPerPage,limit:this.props.rowsPerPage,sortColumn:null!=(s=this.props.columns[this.state.sortColumn])?s.field:void 0,sortDir:this.state.sortDir},e=JSON.stringify(n),(t=this.cache.get(e))?(this.setState(t),void this.setState({loading:!1})):(null==this.requestId&&(this.requestId=0),o=++this.requestId,this.props.onRequestData(n,function(t){return function(s,n){var a,r;if(null==s&&t.requestId===o)return r={rows:n.rows,total:n.total},t.cache.put(e,r),"function"==typeof(a=t.props).onTotalUpdated&&a.onTotalUpdated(r.total),t.setState(r),t.setState({loading:!1})}}(this)))},onColumnHeaderClick:function(e){var t,s;if(this.props.columns[e].sortable!==!1)return t=e===this.state.sortColumn?{sortDir:-this.state.sortDir}:{sortColumn:e,sortDir:null!=(s=this.props.columns[e].initialSortDir)?s:i},this.setState(t,function(e){return function(){return e.refreshData()}}(this))},onChangePage:function(e){return this.setState({currentPage:e},this.refreshData)},render:function(){var e,t,n,o,a,u;return n=0===this.state.total&&!this.state.loading,d.div({className:p(this.props.classes,{"table-container":!0})},n&&this.props.hideHeaderOnEmptyTable?void 0:d.div({className:p(this.props.headerClasses,{"table-header":!0})},function(){var s,n,o,a;for(o=this.props.columns,a=[],e=s=0,n=o.length;n>s;e=++s)t=o[e],a.push(d.div({className:p(t.classes,this.props.cellClasses,{"table-column-header":!0,nonsortable:t.sortable===!1,sorted:t.sortable!==!1&&this.state.sortColumn===e}),style:{width:t.width},onClick:this.onColumnHeaderClick.bind(this,e),key:e},t.header,function(){if(t.sortable!==!1&&this.state.sortColumn===e)switch(this.state.sortDir){case i:return d.span({className:"sort-arrow sort-arrow-up"});case l:return d.span({className:"sort-arrow sort-arrow-down"})}}.call(this)));return a}.call(this)),n?d.div({className:"empty-message"},this.props.emptyMessage):this.state.rows.length>0?d.ol({className:p(this.props.bodyClasses,{"table-body":!0,loading:this.state.loading})},function(){var s,n,r,i,l;for(r=this.state.rows,l=[],u=s=0,n=r.length;n>s;u=++s)o=r[u],a="function"==typeof this.props.rowClasses?this.props.rowClasses(o):this.props.rowClasses,l.push(d.li({className:p(a,{"table-row":!0}),key:u,onClick:null!=(i=this.props.onRowClicked)?i.bind(this,o):void 0},function(){var s,n,a,r,i,l;for(a=this.props.columns,l=[],e=s=0,n=a.length;n>s;e=++s)t=a[e],l.push(d.span({className:p(t.classes,this.props.cellClasses,{"table-cell":!0}),style:{width:t.width},key:e},null!=(r=null!=(i="function"==typeof t.render?t.render(o):void 0)?i:o[t.field])?r:d.span({className:"null-field"},m)));return l}.call(this)));return l}.call(this)):d.div({className:"spacer"}),this.state.loading?d.div({className:"loading-message"},this.props.loadingIndicator?d.img({src:this.props.loadingIndicator}):c("Loading...")):void 0,this.state.total>this.props.rowsPerPage?s.createElement(r,{num_pages:Math.ceil(this.state.total/this.props.rowsPerPage),onChangePage:this.onChangePage}):void 0)}})})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_upsell_modal_banner",["external/react","modules/core/browser","modules/core/uri","modules/clean/react/button","modules/clean/analytics"],function(e,t,s,n,o){var a,r,i,l,u,m;return i=n.button,r=o.TeamsWebActionsLogger,u=e.DOM,l=e.createElement,m=e.PropTypes,a=e.createClass({mixins:[e.addons.PureRenderMixin],propTypes:{upgradeButtonText:m.string.isRequired,upsellText:m.string.isRequired,logEventName:m.string,redirectQuery:m.shape({tk:m.string,_camp:m.string})},displayName:"LimitedTeamUpsellModalBanner",_handleCTAClick:function(){return this.props.logEventName&&r.log(this.props.logEventName,{},null,null,!1,r.LOG_CATEGORY.UPGRADE),t.redirect(s({path:"/team/upgrade",query:this.props.redirectQuery}))},render:function(){return u.div({className:"modal-upsell-bar"},u.div({className:"modal-upsell-bar__message"},this.props.upsellText),u.div({className:"modal-upsell-bar__action"},l(i,{className:"modal-upsell-bar__cta-button",onClick:this._handleCTAClick},this.props.upgradeButtonText)))}})})}.call(this),function(){define("modules/clean/teams/limited_team_settings_modal",["external/react","modules/core/browser","modules/clean/react/button","modules/core/i18n","modules/clean/ajax","modules/clean/analytics","modules/clean/react/input","modules/clean/react/modal","modules/clean/teams/constants","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/teams/notes_link_policy_select","modules/clean/teams/request_membership_policy_select","modules/clean/teams/modals/delete_team_modal","modules/constants/python"],function(e,t,s,n,o,a,r,i,l,u,m,c,p,d){var h,g,f,b,_,v,y,w,C,M,T;return w=s.button,y=n._,v=a.TeamsWebActionsLogger,f=i.Modal,b=l.REQUEST_MEMBERSHIP_POLICY_LABEL_VARIANTS,h=p.DeleteTeamModal,_=d.TRADEMARK_BUSINESS,M=e.DOM,C=e.createElement,T=e.PropTypes,g=e.createClass({mixins:[e.addons.LinkedStateMixin],displayName:"LimitedTeamSettingsModal",propTypes:{onUpdated:T.func,canChangeTeamName:T.bool.isRequired,canDeleteTeam:T.bool.isRequired,canSetTeamRequestMembershipPolicy:T.bool.isRequired,canChangeNotesLinkPolicy:T.bool,teamDomain:T.string.isRequired,teamId:T.number.isRequired,initialTeamName:T.string.isRequired,initialTeamFullName:T.string.isRequired,initialTeamRequestMembershipPolicy:T.number.isRequired,initialNotesLinkPolicy:T.number.isRequired},getInitialState:function(){return{submitting:!1,errors:{},teamName:this.props.initialTeamName,teamRequestMembershipPolicy:this.props.initialTeamRequestMembershipPolicy,notesLinkPolicy:this.props.initialNotesLinkPolicy}},_teamNameHasChanged:function(){return this.state.teamName.trim()!==this.props.initialTeamName},_teamPolicyHasChanged:function(){return this.state.teamRequestMembershipPolicy!==this.props.initialTeamRequestMembershipPolicy},_notesPolicyHasChanged:function(){return this.state.notesLinkPolicy!==this.props.initialNotesLinkPolicy},_canProceed:function(){return!this.state.submitting&&(""!==this.state.teamName.trim()&&this.props.canChangeTeamName&&this._teamNameHasChanged()||this.props.canSetTeamRequestMembershipPolicy&&this._teamPolicyHasChanged())||this.props.canChangeNotesLinkPolicy&&this._notesPolicyHasChanged()},_onAjaxError:function(){return this.setState({submitting:!1})},_onClickSave:function(e){var s,n,a;e.preventDefault(),this.setState({submitting:!0}),a=function(e){return function(t){return e.props.canChangeTeamName&&e._teamNameHasChanged()?o.WebRequest({url:"/team/manage/rename",data:{team_id:e.props.teamId,orig_name:e.props.initialTeamName,orig_full_name:e.props.initialTeamFullName,new_name:e.state.teamName,full_name:e.state.teamName},error:function(t,s,n){return e.setState({errors:function(){try{return JSON.parse(n)}catch(e){}}()}),e._onAjaxError()},success:t}):"function"==typeof t?t():void 0}}(this),n=function(e){return function(t){return e.props.canSetTeamRequestMembershipPolicy&&e._teamPolicyHasChanged()?o.WebRequest({url:"/team/manage/set_request_membership_policy",data:{new_team_policy:e.state.teamRequestMembershipPolicy},error:e._onAjaxError,success:t}):"function"==typeof t?t():void 0}}(this),s=function(e){return function(t){return e.props.canChangeNotesLinkPolicy&&e._notesPolicyHasChanged()?o.WebRequest({url:"/team/manage/set_paper_link_policy",data:{new_link_policy:e.state.notesLinkPolicy},error:e._onAjaxError,success:t}):"function"==typeof t?t():void 0}}(this),a(function(e){return function(){return n(function(){return s(function(){var s;"function"==typeof(s=e.props).onUpdated&&s.onUpdated(),t.reload()})})}}(this))},_onDismissModal:function(){v.log("canceled_update_team_settings")},_renderCTA:function(){return C(u,{upsellText:y("Looking for more advanced settings? Upgrade to get more security features and admin controls."),upgradeButtonText:y("Upgrade to %(trademark_business)s").format({trademark_business:_}),redirectQuery:{tk:"team_settings",_camp:"modal"}})},_renderTeamNameForm:function(){return[M.label({className:"limited-team-settings-modal-content__company-name-label",htmlFor:"limited-team-settings-modal-content__company-name-input"},y("Company name")),C(r.text,{label:y("Company or organization name"),className:"limited-team-settings-modal-content__company-name-input",id:"limited-team-settings-modal-content__company-name-input",valueLink:this.linkState("teamName"),error:this.state.errors.new_name})]},_renderMembershipApprovalPolicyForm:function(){return C(c,{labelVariant:b.FOR_ADMIN,teamDomain:this.props.teamDomain,valueLink:this.linkState("teamRequestMembershipPolicy")})},_renderNotesLinkPolicyForm:function(){return C(m,{teamDomain:this.props.teamDomain,valueLink:this.linkState("notesLinkPolicy")})},_renderDeleteTeamButton:function(){return M.div({className:"delete-team-button-section"},M.button({className:"delete-team-button button-tertiary",onClick:this._deleteTeam},y("Delete team")))},_deleteTeam:function(){return f.showInstance(C(h,{teamName:this.state.teamName,teamId:this.props.teamId}))},render:function(){return C(f,{title:y("Team settings"),acceptButtonText:y("Save settings"),dismissButtonText:y("Cancel"),onAccept:this._onClickSave,onDismiss:this._onDismissModal,acceptButtonDisabled:!this._canProceed(),
submitting:this.state.submitting,altAction:this._renderCTA(),className:"limited-team-settings-modal",ref:"modal"},M.div({className:"limited-team-settings-modal-content"},this.props.canChangeTeamName?this._renderTeamNameForm():void 0,this.props.canSetTeamRequestMembershipPolicy?this._renderMembershipApprovalPolicyForm():void 0,this.props.canChangeNotesLinkPolicy?this._renderNotesLinkPolicyForm():void 0),this.props.canDeleteTeam?this._renderDeleteTeamButton():void 0)}})})}.call(this),function(){define("modules/clean/teams/limited_team_tooltip_runner",["jquery","external/underscore","external/react","external/immutable","modules/core/browser","modules/core/i18n","modules/core/exception","modules/clean/ajax","modules/clean/react/bubble","modules/clean/react/css","modules/clean/react/sprite","modules/clean/react/button","modules/clean/static_urls"],function(e,t,s,n,o,a,r,i,l,u,m,c,p){var d,h,g,f,b,_,v,y,w,C;return f=a._,_=r.assert,C=p.static_url,y=s.DOM,v=s.createElement,w=s.PropTypes,g=n.Record({heading:"",body:"",buttonText:"",arrowDirection:null,cssSelector:"",imageHref:"",imageHrefHires:"",imageHeight:"",imageWidth:null,onButtonClick:null,onButtonClickImmediate:null}),h=function(e,s,n){var o,a;return a=t(e.tooltipSpecs).keys(),t(e[s]).difference(a).length&&(o="Invalid prop "+s+" supplied to "+n+". All "+s+" values must exist in tooltipSpecs"),e[s]||(o="Prop "+s+" must be supplied to "+n+"."),o?new Error(o):void 0},b=s.createClass({BUBBLE_WIDTH:250,displayName:"LimitedTeamTooltipRunner",propTypes:{initialServerStep:w.number.isRequired,serverStepOffset:w.number.isRequired,tooltipSpecs:w.objectOf(w.instanceOf(g)).isRequired,tooltipSpecOrder:h,lastTooltipDismissedCb:w.func,onStepAdvancedCb:w.func},getInitialState:function(){return{currentStepNumber:this.props.initialServerStep-this.props.serverStepOffset,waitingForServerResponse:!1}},componentDidMount:function(){return"complete"===document.readyState?this._initBubbleTracking():e(window).load(this._initBubbleTracking)},componentDidUpdate:function(){return this._setBubbleLocation()},componentWillUnmount:function(){return e(window).off("resize",this._setBubbleLocation)},_initBubbleTracking:function(){return this._setBubbleLocation(),e(window).resize(this._setBubbleLocation)},_specForStepNumber:function(e){return this.props.tooltipSpecs[this.props.tooltipSpecOrder[e]]},_recordStepSeen:function(e){return i.WebRequest({url:"/team/onboarding_event",data:{stage:this.state.currentStepNumber+this.props.serverStepOffset},success:e})},_recordAndAdvance:function(){var e;if(!this.state.waitingForServerResponse)return this.setState({waitingForServerResponse:!0}),e=this._specForStepNumber(this.state.currentStepNumber),"function"==typeof e.onButtonClickImmediate&&e.onButtonClickImmediate(),this._recordStepSeen(function(t){return function(s){var n,o;return n=parseInt(JSON.parse(s).next_state),t.state.currentStepNumber===t.props.tooltipSpecOrder.length-1?t.props.lastTooltipDismissedCb(n):(o=function(){var e;return t.setState({currentStepNumber:n-t.props.serverStepOffset,waitingForServerResponse:!1}),"function"==typeof(e=t.props).onStepAdvancedCb?e.onStepAdvancedCb(n):void 0},e.onButtonClick?e.onButtonClick(o):o())}}(this))},_setBubbleLocation:function(){var t,s,n,o,a,r,i,u,m,c,p,d,h,g,f;if(h=this._specForStepNumber(this.state.currentStepNumber),_((p=h.arrowDirection)===l.ARROW.TOP||p===l.ARROW.LEFT||p===l.ARROW.LEFT_TOP,"trying to setBubbleLocation with unsupported arrow direction. Please add code for computing bubble location"),t=e(".react-bubble-box__arrow-border"),n=e(h.cssSelector),n.length){switch(s=e(this.refs.tooltipBubble.getDOMNode()),d=n.offset(),r=s.offsetParent().offset(),m=d.left-r.left,c=d.top-r.top,u=function(e){return Math.floor(e.outerWidth()/2)},i=function(e){return Math.floor(e.outerHeight()/2)},h.arrowDirection){case l.ARROW.TOP:o=t.outerHeight(),o>40&&(o=18),g=m-u(s)+u(n),f=c+n.outerHeight()+o;break;case l.ARROW.LEFT:a=t.outerWidth(),a>40&&(a=18),g=m+n.outerWidth()+a,f=c-i(s)+i(n);break;case l.ARROW.LEFT_TOP:a=t.outerWidth(),a>40&&(a=18),g=m+n.outerWidth()+a,f=c-i(n)}return s.css({top:f,left:g,visibility:"visible"})}},render:function(){var e;return e=this._specForStepNumber(this.state.currentStepNumber),y.div({className:"limited-team-tooltips"},v(l,{ref:"tooltipBubble",arrow:e.arrowDirection,className:"limited-team-tooltips__bubble",style:{position:"absolute",width:this.BUBBLE_WIDTH,visibility:"hidden"}},y.div({className:"limited-team-tooltips__bubble-contents"},y.img({src:C(e.imageHref),srcHiRes:C(e.imageHrefHires||e.imageHref),className:"limited-team-tooltips__bubble-image",width:e.imageWidth||.84*this.BUBBLE_WIDTH,height:e.imageHeight}),y.h2({},e.heading),y.p({},e.body),y.button({className:"button-primary limited-team-tooltips__bubble-button",onClick:this._recordAndAdvance},e.buttonText))))}}),d=u(b,["/static/css/react/bubble_box-vflhusCtq.css"]),{LimitedTeamTooltipRunner:d,TooltipSpec:g}})}.call(this),function(){define("modules/clean/teams/limited_team_tooltips",["external/react","modules/clean/react/bubble","modules/core/browser","modules/core/i18n","modules/clean/teams/limited_team_tooltip_runner"],function(e,t,s,n,o){var a,r,i,l,u,m;return l=n._,a=o.LimitedTeamTooltipRunner,i=o.TooltipSpec,u=e.createElement,m=e.PropTypes,r=e.createClass({displayName:"LimitedTeamTooltips",propTypes:{onboardingState:m.number.isRequired,lastTooltipDismissedCb:m.func},ONBOARDING_TOOLTIP_INFO:{TEAM_TAB:new i({heading:l("Manage your team"),body:l("Here’s where you can invite people to the team, remove people, change the team name, and more!"),arrowDirection:t.ARROW.LEFT,buttonText:l("Next"),cssSelector:".team-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage-vflXw6tGQ.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage@2x-vflS2wbhg.png",imageHeight:130,onButtonClick:function(){return s.redirect("/team")}}),INVITE_MEMBERS:new i({heading:l("Invite more people"),body:l("Here’s where you can send invites to add more people to your team."),arrowDirection:t.ARROW.TOP,buttonText:l("Next"),cssSelector:".invite-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite-vflwGI3rs.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite@2x-vflujxc7r.png",imageHeight:130}),GROUPS:new i({heading:l("Create and view groups"),body:l("Keep things organized by adding people to a group or creating a new one."),arrowDirection:t.ARROW.TOP,buttonText:l("Next"),cssSelector:"#tab_team-tab-groups",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups-vflUdtiBT.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups@2x-vflYWShtX.png",imageHeight:130}),SETTINGS:new i({heading:l("Team settings"),body:l("Customize details like your company name, Paper sharing settings, and more."),arrowDirection:t.ARROW.TOP,buttonText:l("Next"),cssSelector:".settings-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings-vflTnLAOr.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings@2x-vflClprJl.png",imageHeight:130}),PAPER:new i({heading:l("Dropbox Paper"),body:l("Check out the best way to create and build on ideas with your team."),arrowDirection:t.ARROW.LEFT,buttonText:l("Next"),cssSelector:".composer-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper-vflQyNMh5.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper@2x-vfl7TJoJA.png",imageHeight:130,onButtonClickImmediate:function(){return s.open_tab("/paper")}})},BUBBLE_INFO_ARRAY:["TEAM_TAB","INVITE_MEMBERS","GROUPS","SETTINGS","PAPER"],render:function(){return u(a,{initialServerStep:this.props.onboardingState,lastTooltipDismissedCb:this.props.lastTooltipDismissedCb,serverStepOffset:2,tooltipSpecs:this.ONBOARDING_TOOLTIP_INFO,tooltipSpecOrder:this.BUBBLE_INFO_ARRAY})}})})}.call(this),function(){define("modules/clean/teams/modals/account_pair_suggest_modal",["external/react","modules/core/browser","modules/core/i18n","modules/core/uri","modules/clean/analytics","modules/clean/react/modal"],function(e,t,s,n,o,a){var r,i,l,u,m,c,p;return u=s._,l=o.TeamsWebActionsLogger,i=a.Modal,c=e.DOM,m=e.createElement,p=e.PropTypes,r=e.createClass({displayName:"AccountPairSuggestModal",propTypes:{suggested_email:p.string,current_email:p.string,cont:p.string},componentDidMount:function(){return l.log("account_pair_suggest_modal_shown")},_onContinue:function(){return t.redirect(new n({path:"/team/join/new_pair",query:this.props.cont?{cont:this.props.cont}:{}}))},render:function(){return m(i,{title:u("Connect your personal Dropbox"),acceptButtonText:u("Continue"),onAccept:this._onContinue,className:"account-pair-suggest-modal"},c.div({className:"account-pair-suggest-modal-content"},u("You can connect a personal Dropbox (%(suggested_email)s) with your new work Dropbox (%(current_email)s) to sync both Dropboxes to all your devices. You can easily switch between them without signing in and out, on both web and mobile.").format({suggested_email:this.props.suggested_email,current_email:this.props.current_email})))}})})}.call(this),function(){define("modules/clean/teams/modals/delete_team_modal",["external/react","modules/core/i18n","modules/core/notify","modules/core/browser","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,n,o,a,r){var i,l,u,m,c,p;return u=t._,l=a.Modal,m=e.DOM,c=e.PropTypes,p=r.get_viewer(),i=e.createClass({displayName:"DeleteTeamModal",propTypes:{teamName:c.string.isRequired,teamId:c.number.isRequired},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),o.WebRequest({url:"/team/manage/delete",data:{team_id:this.props.teamId,_subject_uid:p.work_user.id},complete:function(e){return function(){return e.setState({submitting:!1})}}(this),success:function(){return s.success(u("You successfully deleted the team.")),n.redirect("/home")}})},render:function(){var t;return t=u("The %(team_name)s team will be permanently deleted and all members will be removed. Your team’s folders will be converted to shared folders, nested shared folders will be flattened and your %(team_name)s groups will be deleted. Every member’s account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}),e.createElement(l,{title:u("Delete team?"),acceptButtonText:u("Delete"),dismissButtonText:u("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},t)}}),{DeleteTeamModal:i}})}.call(this),function(){define("modules/clean/teams/modals/leave_team_modal",["external/react","modules/core/i18n","modules/core/notify","modules/core/browser","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,n,o,a,r){var i,l,u,m,c,p,d,h;return c=t._,m=a.Modal,p=e.DOM,d=e.PropTypes,h=r.get_viewer(),u=e.createClass({displayName:"LeaveTeamModal",propTypes:{teamName:d.string,canHaveAdminUi:d.bool},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),o.WebRequest({url:"/team/manage/leave",data:{user_id:h.work_user.id},complete:function(e){return function(){return e.setState({submitting:!1})}}(this),success:function(){return s.success(c("You left the team.")),n.redirect("/team")}})},render:function(){var t;return t=this.props.canHaveAdminUi?c("You’ll lose access to all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}):c("You’ll lose access to the %(team_name)s team folder and all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}),e.createElement(m,{title:c("Leave team?"),acceptButtonText:c("Leave team"),dismissButtonText:c("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},t)}}),i=e.createClass({displayName:"LeaveTeamAsSoleLimitedAdminWarningModal",propTypes:{teamName:d.string},render:function(){return e.createElement(m,{title:c("You must give admin permissions to someone else"),acceptButtonText:c("I understand"),submitting:!1,autoClose:!0},c("Since you’re the only admin of %(team_name)s, you need to give someone else on your team admin permissions before you leave the team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”.").format({team_name:this.props.teamName}))}}),l=e.createClass({displayName:"LeaveTeamButton",propTypes:{teamName:d.string,showWarningOnLeaveTeam:d.bool,canHaveAdminUi:d.bool},showLeaveTeamModal:function(){return this.props.showWarningOnLeaveTeam?m.showInstance(e.createElement(i,{teamName:this.props.teamName})):m.showInstance(e.createElement(u,{teamName:this.props.teamName,canHaveAdminUi:this.props.canHaveAdminUi}))},render:function(){return p.button({className:"leave-team-button",onClick:this.showLeaveTeamModal},c("Leave team"))}}),{LeaveTeamModal:u,LeaveTeamButton:l}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/teams/modals/limited_team_file_upload_modal",["external/react","external/underscore","modules/core/i18n","modules/core/browser","modules/core/uri","modules/clean/ajax","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/button","modules/clean/react/file_uploader/actions","modules/clean/react/file_uploader/uploader","modules/clean/react/modal","modules/clean/static_urls","modules/clean/teams/constants","modules/clean/teams/limited_team_tooltips","modules/clean/teams/sign_up_for_team/desktop_client_install_modal","modules/clean/react/sprite","modules/clean/react/table","modules/clean/viewer","modules/core/notify"],function(t,s,n,o,a,r,i,l,u,m,c,p,d,h,g,f,b,_,v,y){var w,C,M,T,N,S,A,k,R,D,x,E,P,I,L,O,G;return x=n._,R=i.TeamsWebActionsLogger,P=u.button,D=m.UploaderActions,T=c.FileUploader,A=p.Modal,G=d.static_url,w=h.ADMIN_ONBOARDING_STATES,C=f.DesktopClientInstallModal,L=t.DOM,I=t.createElement,O=t.PropTypes,E=function(e,t){var s,n,o;n={};for(o in e)s=e[o],n[o]=s.bind(t);return n},N=t.createClass({displayName:"LimitedTeamFileUploadIntroModal",propTypes:{onCloseCallback:O.func,buttonText:O.string},onClose:function(e){return e.preventDefault(),this.props.onCloseCallback()},componentDidMount:function(){return R.log("welcome_team_modal")},render:function(){return I(A,{acceptButtonText:this.props.buttonText,clickOutToClose:!1,onAccept:this.onClose,onDismiss:this.onClose,width:720,style:"clean",className:"limited-team-file-upload-modal",ref:"intro-modal"},L.div({className:"limited-team-file-upload-modal-content u-mar-top-l"},L.img({src:G("/static/images/teams/onboarding/admin-onboarding-modal-vflV4rJnP.png"),srcHiRes:G("/static/images/teams/onboarding/admin-onboarding-modal@2x-vflDinfiz.png"),className:"limited-team-file-upload-modal-content__image"}),L.h1({},x("Welcome to your Team Dropbox")),L.p({className:"limited-team-file-upload-modal-content-description"},x("A centralized place for you and your team to instantaneously share files with each other"))))}}),M=t.createClass({displayName:"FileTransferModal",propTypes:{files:O.arrayOf(O.string),teamFolderFqPath:O.string,onModalDismissed:O.func},getDefaultProps:function(){return{files:[]}},getInitialState:function(){return{transferredFile:!1}},componentWillUnmount:function(){var e;return"function"==typeof(e=this.props).onModalDismissed?e.onModalDismissed():void 0},moveFiles:function(e){var t;return t=a({path:"/cmd/move",query:{long_running:1}}),r.WebRequest({url:t,data:{to_path:this.props.teamFolderFqPath,files:e,_subject_uid:v.get_viewer().work_user},success:function(e){return function(t){var s;return e.setState({transferredFile:!0}),y.success(x("Successfully transferred files to your Team Dropbox!")),null!=(s=e.refs.singleDirectoryFileListing)?s.forceRefresh():void 0}}(this)})},render:function(){return I(A,{buttonComponent:L.span({},""),clickOutToClose:!0,onAccept:this._uploadSelectedFiles,width:720,title:x("Add files to your Team Folder"),ref:"fileTransferModal",className:"file-transfer-modal"},L.div({},L.div({className:"file-transfer-modal__text"},L.p({className:"u-mar-bottom-l"},x("Help your team to hit the ground running by moving some files into your Team folder. That way when they join, they have all of the the files they need to get work done.")),L.div({className:"file-transfer-modal__text--sprite u-mar-bottom-l u-mar-left-m"},I(b,{group:"web",name:"folder_paper_team_32",alt:"generic folder icon"}))),I(k,{ref:"singleDirectoryFileListing",className:"single-directory-file-listing",path:"/",excludedFileFqPaths:[this.props.teamFolderFqPath],primaryButtonText:x("Move Files to Team Folder"),primaryButtonCallback:this.moveFiles,secondaryButtonText:x(this.state.transferredFile?"All done":"Cancel"),secondaryButtonCallback:function(e){return function(){return e.refs.fileTransferModal.close()}}(this)})))}}),k=t.createClass({displayName:"SingleDirectoryFileListing",propTypes:{path:O.string,excludedFileFqPaths:O.arrayOf(O.string),primaryButtonText:O.string,primaryButtonCallback:O.func,secondaryButtonText:O.string,secondaryButtonCallback:O.func},getDefaultProps:function(){return{path:"/",primaryButtonCallback:function(){},excludedFileFqPaths:[]}},columnTypes:{sprite:function(e){return{field:"sprite",classes:{"file-transfer-modal-table__sprite-col":!0},header:"",width:e,sortable:!1,render:function(e){return I(b,{group:"web",name:e.icon,alt:x("file icon")})}}},filename:function(e){return{field:"filename",classes:{"file-transfer-modal-table__filename-col":!0},header:"",width:e,sortable:!1,render:function(e){return function(t){var s;return s=t.filename.substring(e.props.path.length),L.span({},s)}}(this)}},selectButton:function(e){return{field:"selectButton",classes:{"file-transfer-modal-table__select-col":!0},header:"",width:e,sortable:!1,render:function(e){return function(t){return L.button({className:"button-as-link"},x(e.state.files[t.filename]?"Unselect":"Select"))}}(this)}}},selectClicked:function(e){var t,n;return t=e.filename,n=this.state.files,n[t]=!n[t],this.setState({buttonEnabled:s.any(s.values(n)),files:n})},componentWillMount:function(){return this.columnTypes=E(this.columnTypes,this)},componentDidMount:function(){return this.refs.fileslist.forceRefresh()},getInitialState:function(){return{files:{},buttonEnabled:!1}},forceRefresh:function(){return this.refs.fileslist.forceRefresh()},rowClass:function(e){var t;return t=this.state.files[e.filename],t?{"file-transfer-modal-table__row--selected":!0}:{"file-transfer-modal-table__row--unselected":!0}},primaryButton:function(){return I(P,{disabled:!this.state.buttonEnabled,className:"file-transfer-modal__button--primary u-mar-right-s",onClick:this.submitClicked},this.props.primaryButtonText)},secondaryButton:function(){return I(P,{className:"file-transfer-modal__button--secondary",importance:"tertiary",onClick:this.props.secondaryButtonCallback},this.props.secondaryButtonText)},submitClicked:function(){var e,t,s;return this.setState({buttonEnabled:!1}),s=function(){var e;e=[];for(t in this.state.files)this.state.files[t]&&e.push(t);return e}.call(this),"function"==typeof(e=this.props).primaryButtonCallback?e.primaryButtonCallback(s):void 0},render:function(){var t,s;return s=62,t=100,L.div({},L.div({className:"file-transfer-modal__table-wrapper-div"},I(_,{ref:"fileslist",classes:{"grey-style":!0,"file-transfer-modal-table":!0},headerClasses:{"file-transfer-modal-table__header":!0},rowClasses:this.rowClass,columns:[this.columnTypes.sprite(s),this.columnTypes.filename(600-s-t),this.columnTypes.selectButton(t)],initialData:{rows:[],total:0},initialSortColumn:1,rowsPerPage:999999,loadingIndicator:G("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),onRequestData:function(t){return function(s,n){var o,a;return o=v.get_viewer().work_user,a="/browse"+t.props.path,r.WebRequest({url:a,data:{_subject_uid:o},success:function(s){var o,a,r,i,l,u,m,c,p;for(s=JSON.parse(s),a=[],r={},m=s.file_info,l=0,u=m.length;u>l;l++)o=m[l],c=o.fq_path,e.call(t.props.excludedFileFqPaths,c)<0&&(i=o.fq_path,p=i in t.state.files?t.state.files[i]:!1,a.push({filename:i,selected:p,icon:o.icon}),r[i]=p,t.setState({files:r}));return n(null,{rows:a,total:a.length})}})}}(this),onRowClicked:function(e){return function(t){return e.selectClicked(t)}}(this)})),L.div({style:{float:"right"}},this.primaryButton(),this.secondaryButton()))}}),S=t.createClass({displayName:"LimitedTeamFileUploadManager",propTypes:{path:O.string,modalVariant:O.oneOf(["UPLOAD","TRANSFER"]),transferPath:O.string,teamFolderFqPath:O.string,showDesktopClientInstallModal:O.bool,createUploaderComponent:O.bool,installPageInformation:O.object,showModalOnPageLoad:O.bool,initialOnboardingState:O.number},getDefaultProps:function(){return{transferPath:"/",modalVariant:"TRANSFER",createUploaderComponent:!0,showModalOnPageLoad:!1,path:""}},getInitialState:function(){return{onboardingState:this.props.initialOnboardingState+1}},componentDidMount:function(){return D.setPath({path:this.props.path||"/"}),D.setUser({user:v.get_viewer().work_user}),this.props.showModalOnPageLoad&&this.state.onboardingState===w.UPLOAD_MODAL?this.showIntroModal():void 0},_shouldShowBubbles:function(){var e,t;return this.onBrowsePage()?w.UPLOAD_MODAL<(e=this.state.onboardingState)&&e<w.INVITATION_TOOLTIP:w.TEAM_TAB_TOOLTIP<(t=this.state.onboardingState)&&t<w.DONE},showIntroModal:function(){var e;return e=x("Next"),this.state.onboardingState<=w.UPLOAD_MODAL?A.showInstance(I(N,{onCloseCallback:this.onIntroModalDismissed,buttonText:e})):void 0},onFileUploadComplete:function(){return r.WebRequest({url:"/team/onboarding_event",data:{stage:w.UPLOADED_FILE},success:function(){},error:function(){}})},onIntroModalDismissed:function(){switch(r.WebRequest({url:"/team/onboarding_event",data:{stage:w.UPLOAD_MODAL},complete:function(e){return function(){return!e.props.createUploaderComponent&&e.onBrowsePage()?e.onUploadModalDismissed():void 0}}(this)}),this.props.modalVariant){case"UPLOAD":return this.refs.fileUploader?this.refs.fileUploader.showModal():T.showModal(),R.log("files_upload_modal");case"TRANSFER":return R.log("files_transfer_modal"),A.showInstance(I(M,{teamFolderFqPath:this.props.path}))}},onUploadModalDismissed:function(){var e;return this.onBrowsePage()?this.setState({onboardingState:this.state.onboardingState+1}):(e=a({path:"/home"+this.props.path}),o.redirect(e))},onBrowsePage:function(){var e;return e=o.get_uri().getPath(),e.indexOf("/home")>=0||e.indexOf("/work")>=0},onLastTooltipDismissed:function(e){return this.setState({onboardingState:e}),this.props.showDesktopClientInstallModal?A.showInstance(I(C,{installPageInformation:this.props.installPageInformation,unmountCallback:this.onClientInstallModalDismissed})):void 0},render:function(){var e;return"UPLOAD"===this.props.modalVariant&&this.props.createUploaderComponent&&this.state.onboardingState<=w.UPLOAD_MODAL&&(e=I(T,{ref:"fileUploader",dragAndDropEnabled:!1,clickOutToClose:!0,shouldShowDestinationLink:!1,onModalDismissed:this.onUploadModalDismissed,onFileUploadComplete:this.onFileUploadComplete})),L.div({className:"teams-page-file-upload-manager"},e?e:void 0,this._shouldShowBubbles()?I(g,{onboardingState:this.state.onboardingState,lastTooltipDismissedCb:this.onLastTooltipDismissed}):void 0)}}),{LimitedTeamFileUploadManager:S}})}.call(this),function(){define("modules/clean/teams/modals/limited_team_max_size_modal",["external/react","modules/core/browser","modules/core/uri","modules/core/user_i18n","modules/core/i18n","modules/clean/react/react_i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/limited_team_invite_form","modules/clean/avatar/avatar_with_default","modules/clean/avatar/photo_avatar","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size"],function(e,t,s,n,o,a,r,i,l,u,m,c,p,d){var h,g,f,b,_,v,y,w;return _=o._,b=a.R_,f=l.Modal,h=d.AVATAR_DIMENSION_BY_SIZE,v=e.createElement,y=e.DOM,w=e.PropTypes,g=e.createClass({displayName:"LimitedTeamMaxSizeModal",propTypes:{showAdminVersion:w.bool,teamMembersLimit:w.number,contacts:w.arrayOf(w.shape({display_name:w.string.isRequired,email:w.string.isRequired,account_photo_url:w.string}))},getInitialState:function(){return{submitting:!1}},onButtonClick:function(){return this.props.showAdminVersion?this.redirectToUpgrade():this.notifyAdmins()},notifyAdmins:function(){return this.setState({submitting:!0}),i.WebRequest({url:"/team/notify_admins_max_team_size_upsell_modal",complete:function(e){return function(){return e.setState({submitting:!1})}}(this),success:function(){return f.close(),r.success(_("We’ve notified your admins."))},error:function(){return r.error()}})},redirectToUpgrade:function(){var e;return e={tk:this.props.teamMembersLimit,camp:"modal"},t.redirect(s({path:"/team/upgrade",query:e}))},onDismissModal:function(){return f.close()},facePileWithLock:function(){var e;return y.div({className:"limited-team-max-size-modal__avatars"},function(){var t,s,o,a;for(o=this.props.contacts.slice(0,5),a=[],t=0,s=o.length;s>t;t++)e=o[t],a.push(y.div({className:"limited-team-max-size-modal__contact-avatar",key:"contact-"+e.email},v(m,{dimension:h.LARGE,photoUrl:e.account_photo_url,defaultAvatar:v(p,{dimension:h.LARGE,name:e.display_name,initials:n.getInitials(e.display_name||e.email),shape:"CIRCLE"})})));return a}.call(this),y.div({className:"limited-team-max-size-modal__contact-avatar"},v(c,{dimension:h.LARGE,photoUrl:"/static/images/teams/private_cir@2x-vflv746EN.png"})))},render:function(){var e;return e=_(this.props.showAdminVersion?"Upgrade to Dropbox Business":"Notify your admins"),v(f,{title:_("You’ve reached the maximum team size"),acceptButtonText:e,acceptButtonDisabled:this.state.submitting,autoClose:!1,onAccept:this.onButtonClick,onDismiss:this.onDismissModal,submitting:this.state.submitting,className:"limited-team-max-size-modal"},this.facePileWithLock(),b({max_size:this.props.teamMembersLimit},'You’re currently on the free plan which only allows you to add up to %(max_size)s members. Upgrade to Dropbox Business to add as many members as you want! <br/> <br/> Dropbox Business also gives you all the space you need, advanced security features, and dedicated live support. <a href="/team/upgrade?tk=%(max_size)s&_camp=modal">Learn more</a>.'))}})})}.call(this),function(){define("modules/clean/teams/modals/remove_member_modal",["external/react","external/purify","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/constants","modules/clean/react/select","modules/clean/react/sprite","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/viewer","modules/clean/analytics","modules/constants/python"],function(e,t,s,n,o,a,r,i,l,u,m,c,p){var d,h,g,f,b,_,v,y,w,C;return _=s._,h=a.Modal,d=r.JOIN_STATES,b=c.TeamsWebActionsLogger,f=p.TRADEMARK_BUSINESS,y=e.DOM,w=e.PropTypes,v=e.createElement,C=m.get_viewer(),g=e.createClass({displayName:"RemoveMemberModal",propTypes:{teamName:w.string,showUpsellVariant:w.string,user:w.object,onRemoved:w.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return b.log("teams_click_remove_member_confirm",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:C.team_id}),this.setState({submitting:!0}),o.WebRequest({url:this.props.user.join_request_status?"/team/join_request/reject":"/team/manage/kick",data:{user_id:this.props.user.user_id},complete:function(e){return function(){return e.isMounted()?e.setState({submitting:!1}):void 0}}(this),success:function(e){return function(){var t;return e.props.user.team_join_state===d.ACTIVE?n.success(_("Member removed.")):n.success(_("Pending member removed.")),h.close(),"function"==typeof(t=e.props).onRemoved?t.onRemoved():void 0}}(this)})},onShow:function(){return b.log("teams_seen_remove_member_modal",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:C.team_id})},onDismiss:function(){return b.log("teams_click_remove_member_cancel",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:C.team_id})},getNameToUse:function(e){return e.display_name?_("%(user_name)s (%(user_email)s)").format({user_name:e.display_name,user_email:e.email}):_("%(user_email)s").format({user_email:e.email})},_getSignedInUser:function(){return C.work_user||C.personal_user},_renderCTA:function(){return v(u,{upsellText:_("Unlock the options to remote wipe and transfer files by upgrading to %(trademark_business)s").format({trademark_business:f}),upgradeButtonText:_("Upgrade to %(trademark_business)s").format({trademark_business:f}),redirectQuery:{tk:"remove_member",_camp:"modal"}})},render:function(){var e,s;return s=this.props.user.team_join_state===d.ACTIVE,e=this._getSignedInUser(),v(h,{title:_(s?"Remove member?":"Remove pending member?"),acceptButtonText:_("Remove"),dismissButtonText:_("Cancel"),submitting:this.state.submitting,autoClose:!1,altAction:this.props.showUpsellVariant&&s?this._renderCTA():null,onAccept:this.onAccept,onShow:this.onShow,onDismiss:this.onDismiss},y.div({className:"remove-member-modal-section"},y.div({className:"remove-member-modal-description"},s?this.props.user.is_admin?_("%(user_presented_name)s will lose access to all %(team_name)s groups. %(user_first_name)s’s account will be converted to a personal Dropbox.").format({user_first_name:t.sanitize(this.props.user.fname),user_presented_name:t.sanitize(this.getNameToUse(this.props.user)),user_email:t.sanitize(this.props.user.email),team_name:t.sanitize(this.props.teamName)}):_("%(user_presented_name)s will lose access to the %(team_name)s team folder and be removed from all %(team_name)s groups. %(user_first_name)s’s account will be converted to a personal Dropbox.").format({user_first_name:t.sanitize(this.props.user.fname),user_presented_name:t.sanitize(this.getNameToUse(this.props.user)),user_email:t.sanitize(this.props.user.email),team_name:t.sanitize(this.props.teamName)}):_("%(user_presented_name)s will be removed from the members list. Any invitation or activation links you’ve sent will no longer work.").format({team_name:t.sanitize(this.props.teamName),user_presented_name:t.sanitize(this.getNameToUse(this.props.user))})),this.props.showUpsellVariant&&s?[y.div({className:"remove-member-modal-disabled-feature u-mar-top-m"},y.input({type:"checkbox",checked:!1,disabled:!0},_("Remote wipe this member’s %(team_name)s team files.").format({team_name:t.sanitize(this.props.teamName)}),y.a({className:"remove-member-modal-info",href:"/en/help/4227",target:"_blank"},v(l,{group:"web",name:"info"})))),y.div({className:"remove-member-modal-disabled-feature u-mar-top-m"},y.input({type:"checkbox",checked:!1,disabled:!0},_("Transfer this user’s files to"),y.a({className:"remove-member-modal-info",href:"/en/help/4228",target:"_blank"},v(l,{group:"web",name:"info"})))),v(i.input,{className:"remove-member-modal-transfer-files-select u-mar-top-xs u-mar-btm-m",value:0,"disable-errors":!0,isDisabled:!0},v(i.option,{value:0},e.display_name+" ("+e.email+")"))]:void 0))}}),{RemoveMemberModal:g}})}.call(this),function(){define("modules/clean/teams/modals/set_limited_admin_modals",["external/react","external/purify","modules/core/notify","modules/core/i18n","modules/clean/react/react_i18n","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/constants"],function(e,t,s,n,o,a,r,i){var l,u,m,c,p,d,h,g,f;return h=n._,c=o.R_,m=r.Modal,l=i.ADMIN_ROLE,g=e.DOM,f=e.PropTypes,u=e.createClass({displayName:"GiveLimitedAdminModal",propTypes:{targetUser:f.object,teamId:f.number,onSuccess:f.func
},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),a.WebRequest({url:"/account/team/set_admin_status",data:{team_id:this.props.teamId,user_id:this.props.targetUser.user_id,on:"yes",role:l.LIMITED},success:function(e){return function(){return e.props.onSuccess(),m.close()}}(this),complete:function(e){return function(){return e.isMounted()?e.setState({submitting:!1}):void 0}}(this)})},render:function(){var t;return t=c({user_name:this.props.targetUser.display_name},'Are you sure you want to give admin permissions to %(user_name)s? All users with admin permissions will be able to upgrade this team to <a href="/business">Dropbox Business</a>.'),e.createElement(m,{title:h("Change Admin Permissions for %(user_name)s").format({user_name:this.props.targetUser.display_name}),acceptButtonText:h("Confirm"),dismissButtonText:h("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},g.div({},t))}}),p=e.createClass({displayName:"RemoveLimitedAdminModal",propTypes:{targetUser:f.object,teamId:f.number,removingOwnPermissions:f.bool,onSuccess:f.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),a.WebRequest({url:"/account/team/set_admin_status",data:{team_id:this.props.teamId,user_id:this.props.targetUser.user_id,on:"no",role:l.NONE},success:function(e){return function(){return e.props.onSuccess(),m.close()}}(this),complete:function(e){return function(){return e.isMounted()?e.setState({submitting:!1}):void 0}}(this)})},render:function(){var t,s;return this.props.removingOwnPermissions?(s=h("Are you sure you no longer want admin permissions?"),t=h("If you remove your admin permissions, you’ll no longer be able to upgrade or delete your team, change team settings, or remove invited and existing users.")):(s=h("Remove admin permissions for %(user_name)s").format({user_name:this.props.targetUser.display_name}),t=c({user_name:this.props.targetUser.display_name},'%(user_name)s won’t be able to manage team settings, remove and un-invite users, or upgrade the team to <a href="/business">Dropbox Business</a>. Are you sure you want to continue?')),e.createElement(m,{title:s,acceptButtonText:h("Confirm"),dismissButtonText:h("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},g.div({},t))}}),d=e.createClass({displayName:"RemoveLimitedAdminWarningModal",render:function(){return e.createElement(m,{title:h("You must give admin permissions to someone else"),acceptButtonText:h("I understand"),submitting:!1,autoClose:!0},h("In order to remove your admin permissions, you must first give admin permissions to someone else on your team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”."))}}),{GiveLimitedAdminModal:u,RemoveLimitedAdminModal:p,RemoveLimitedAdminWarningModal:d}})}.call(this),function(){define("modules/clean/teams/notes_link_policy_select",["external/react","modules/core/i18n","modules/clean/react/select","modules/clean/teams/constants"],function(e,t,s,n){var o,a,r,i,l,u,m,c;return l=t._,r=n.NOTES_LINK_POLICY_VALUES,a=n.NOTES_LINK_POLICY_LABELS,u=e.createElement,m=e.DOM,c=e.PropTypes,o=[r.TEAM,r.PUBLIC],i=e.createClass({displayName:"NotesLinkPolicySelect",propTypes:{teamDomain:c.string.isRequired,defaultValue:c.oneOf(o).isRequired,valueLink:c.shape({value:c.oneOf(o).isRequired,requestChange:c.func.isRequired}),onChange:c.func},render:function(){var e;return m.div({className:"notes-link-policy-select"},m.div({className:"notes-link-policy-select__label-wrapper"},m.label({className:"notes-link-policy-select__label"},l("Who do you want to be able to open links to Paper docs by default?"))),u(s.input,{className:"notes-link-policy-select__select","disable-errors":!0,defaultValue:this.props.defaultValue,valueLink:this.props.valueLink,onChange:this.props.onChange},function(){var t,n,r;for(r=[],t=0,n=o.length;n>t;t++)e=o[t],r.push(u(s.option,{value:e,key:e},a[e]));return r}()))}})})}.call(this),function(){define("modules/clean/teams/sign_up_for_team/desktop_client_install_modal",["external/react","jquery","modules/core/i18n","modules/core/browser","modules/core/uri","modules/clean/ajax","modules/clean/react/button","modules/clean/react/modal","modules/clean/react/react_i18n"],function(e,t,s,n,o,a,r,i,l){var u,m,c,p,d,h,g,f;return p=s._,d=r.button,m=i.Modal,c=l.R_,g=e.DOM,h=e.createElement,f=e.PropTypes,u=e.createClass({displayName:"DesktopClientInstallModal",propTypes:{installPageInformation:f.object,unmountCallback:f.func},componentWillUnmount:function(){return this.props.unmountCallback?this.props.unmountCallback():void 0},componentDidMount:function(){return t(".desktop-client-install-modal__offline-install-link").click(this.downloadClicked.bind(this,this.offlineURI()))},downloadClicked:function(e){return n.redirect(e)},onlineURI:function(){return o({path:"/downloading",query:{os:this.props.installPageInformation.os}})},offlineURI:function(){return this.onlineURI().updateQuery({full:1})},versionNo:function(){var e,t;return e=function(){switch(this.props.installPageInformation.os){case"lnx":return"Linux";case"win":return"Windows";case"mac":return"Mac"}}.call(this),t=this.props.installPageInformation.buildNo,p("%(client_version_number)s for %(platform)s",{comment:'version_number looks like "2.10.3", platform is "Windows" or "Mac" or "Linux"'}).format({client_version_number:t,platform:e})},renderTitle:function(){return g.h1({className:"desktop-client-install-modal__title u-mar-top-xl u-mar-bottom-m"},p("Get your Team Dropbox on your computer"))},renderText:function(){return g.p({className:"desktop-client-install-modal__text"},p("Download Dropbox and you’ll be ready to work with your team!"))},renderButton:function(){return h(d,{className:"desktop-client-install-modal__button u-mar-bottom-s",variant:"big",onClick:this.downloadClicked.bind(this,this.onlineURI())},p("Download"))},renderVersionNo:function(){return g.p({className:"desktop-client-install-modal__version-no u-mar-bottom-l u-font-meta"},this.versionNo())},renderOfflineLink:function(){return c({},'Or download the <a class="desktop-client-install-modal__offline-install-link">Offline Installer</a>')},render:function(){return h(m,{className:"desktop-client-install-modal",style:"clean",width:720,buttonComponent:g.span(),ref:"desktop-client-modal"},this.renderTitle(),this.renderText(),this.renderButton(),this.renderVersionNo(),this.renderOfflineLink())}}),{DesktopClientInstallModal:u}})}.call(this),function(){define("modules/clean/teams/team_page",["jquery","external/react","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/core/user_i18n","modules/clean/ajax","modules/clean/analytics","modules/clean/contacts/data","modules/clean/contacts/types","modules/clean/react/bubble","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/table","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/style","modules/clean/react/button","modules/clean/react/dbox_app_promo","modules/clean/teams/cdm_mve_util","modules/clean/teams/constants","modules/clean/teams/limited_team_invite_and_settings_modal","modules/clean/teams/limited_team_invite_modal","modules/clean/teams/limited_team_settings_modal","modules/clean/teams/limited_team_tooltips","modules/clean/teams/suggest_invites_modal","modules/clean/teams/modals/account_pair_suggest_modal","modules/clean/teams/modals/leave_team_modal","modules/clean/teams/modals/remove_member_modal","modules/clean/teams/modals/set_limited_admin_modals","modules/clean/teams/modals/limited_team_file_upload_modal","modules/clean/teams/modals/limited_team_max_size_modal","modules/clean/teams/prop_types","modules/clean/viewer"],function(e,t,s,n,o,a,r,i,l,u,m,c,p,d,h,g,f,b,_,v,y,w,C,M,T,N,S,A,k,R,D,x,E,P,I,L){var O,G,U,q,B,j,F,H,W,V,z,J,Q,Y,K,X,Z,$,ee,te,se,ne,oe,ae;return $=n._,K=l.TeamsWebActionsLogger,q=u.Contact,V=p.Modal,G=h.BubbleMenu,U=h.BubbleMenuItem,se=_.colorValueForAvatarName,O=y.Actionable,F=C.JOIN_STATES,X=C.USER_TYPES,j=C.JOIN_REQUEST_STATUS,H=R.LeaveTeamModal,Q=D.RemoveMemberModal,B=x.GiveLimitedAdminModal,z=x.RemoveLimitedAdminModal,J=x.RemoveLimitedAdminWarningModal,W=E.LimitedTeamFileUploadManager,ne=t.DOM,te=t.createElement,ae=e.extend({},t.PropTypes,I),Z={},Z[X.PENDING_TEAM_ADMIN]=$("Team Admin"),Z[X.PENDING_ACCOUNTS_ADMIN]=$("User Management Admin"),Z[X.PENDING_SUPPORT_ADMIN]=$("Support Admin"),Z[X.PENDING_MEMBER]=$("Member"),Z[X.TEAM_ADMIN]=$("Team Admin"),Z[X.ACCOUNTS_ADMIN]=$("User Management Admin"),Z[X.SUPPORT_ADMIN]=$("Support Admin"),Z[X.MEMBER]=$("Member"),Z[X.SUSPENDED]=$("Suspended"),Z[X.REMOVED]=$("Removed"),ee=function(e,t){var s,n,o;n={};for(o in e)s=e[o],n[o]=s.bind(t);return n},oe=function(e){return e.team_join_state===F.ACTIVE},Y=t.createClass({displayName:"TeamPage",propTypes:{members:ae.array,total:ae.number,numJoinRequests:ae.number,teamName:ae.string,teamFullName:ae.string,teamDomain:ae.string,teamFolderPathName:ae.string,teamRequestMembershipPolicy:ae.number,isLimitedTeam:ae.bool,notesLinkPolicy:ae.number,canInviteMembers:ae.bool,canManageTeamMembership:ae.bool,canSuggestMembers:ae.bool,canAccessAdminConsole:ae.bool,canDeleteTeam:ae.bool,canChangeTeamName:ae.bool,canSetTeamRequestMembershipPolicy:ae.bool,canSetNotesLinkPolicy:ae.bool,canHaveLimitedAdminSettings:ae.bool,canManageLimitedAdmins:ae.bool,viewerIsSoleAdmin:ae.bool,hasSettingsDialog:ae.bool,inviteMemberEmails:ae.arrayOf(ae.string),suggestedMembers:ae.arrayOf(ae.suggestedMember),openInviteModal:ae.bool,openSettingsModal:ae.bool,openSuggestMembersModal:ae.bool,openUploadModal:ae.bool,onboardingModalVariant:ae.string,openInviteAndSettingsModal:ae.bool,pendingPersonalEmail:ae.string,adminOnboardingState:ae.number,teamMembersLimit:ae.number,enableMaxSizeExperiment:ae.bool,showCdmMveUi:ae.bool,showUpsellVariant:ae.string,viewer:ae.instanceOf(L),installPageInformation:ae.object,hasSeenClientInstallUi:ae.bool},getDefaultProps:function(){return{viewer:L.get_viewer(),hasSeenClientInstallUi:!0}},getInitialState:function(){return{totalMembersListLength:this.props.total,numJoinRequests:this.props.numJoinRequests,visibleMembers:this.props.members}},columnTypes:{displayName:function(e){return{field:"display_name_lower",header:$("Name"),classes:{"display-name-column":!0},width:e,render:function(e){return function(e){return ne.span({},te(f,{dimension:24,photoUrl:e.account_photo_url,optionalClass:"u-mar-right-xs",defaultAvatar:te(b,{dimension:24,initials:r.getInitials(e.display_name||e.email),color:oe(e)?se(e.display_name):"#aaa",shape:"CIRCLE",optionalClass:"u-mar-right-xs"})}),ne.span({className:"user-name"},e.display_name||$("Invited")),ne.span({className:"user-email"},e.email))}}(this)}},userType:function(e){return{field:"user_type",header:$("Status"),width:e,render:function(e){return function(t){return ne.span({className:"member-user-type"},function(){if(!this.props.isLimitedTeam)return Z[t.user_type];if(t.is_admin)return $("Admin");if(t.join_request_status)switch(t.join_request_status){case j.PENDING:return $("Requested Membership");case j.APPROVED:return $("Approved")}else switch(t.team_join_state){case F.ACTIVE:return $("Member");case F.PENDING:return $("Invited");case F.SUSPENDED:return $("Suspended");case F.REMOVED:return $("Removed");default:return $("Invalid")}}.call(e))}}(this)}},storageUsed:function(e){return{field:"storage_used",header:$("Usage"),width:e,initialSortDir:g.DESC_DIR,render:function(e){return function(t){var s,n;return n=t.storage_used||"-",s="",e.props.showCdmMveUi&&t.storage_used&&(s=w.calculateQuotaClass(t.used_raw_bytes/t.quota_raw_bytes),n=$("%(usage)s / %(user_quota)s").format({usage:n,user_quota:t.quota})),ne.span({className:s},n)}}(this)}},approveUser:function(e){return{width:e,classes:{"approve-request-column":!0},render:function(e){return function(t){var s;return s=t.join_request_status===j.PENDING,s&&e.props.canManageTeamMembership?te(O,{handler:e.onApproveRequest.bind(e,t)},te(v.button,{className:"button-primary action-button approve-button"},$("Approve"))):""}}(this)}},adminManagement:function(e){return{width:e,classes:{"limited-admin-management-col":!0},render:function(e){return function(t){return e.props.canHaveLimitedAdminSettings?e.adminGear(t):e.removeUserButton(t)}}(this)}},joinedDate:function(e){return{field:"team_joined_utc_ts",header:$("Joined"),width:e,render:function(e){return function(e){return e.joined||"—"}}(this)}}},adminGear:function(e){var t,s;return t=ne.button({className:"limited-admin-settings-button"},te(d,{group:"web",name:"gear",alt:$("Member settings")})),s=[],e.user_id===this.props.viewer.work_user.id?this.props.canManageLimitedAdmins&&s.push(te(U,{onClick:this.onRemoveAdminPermission.bind(this,e)},$("Remove my admin permissions"))):(this.props.canManageTeamMembership&&s.push(te(U,{onClick:this.onRemoveMember.bind(this,e)},$("Remove team member"))),this.props.canManageLimitedAdmins&&oe(e)&&(e.is_admin?s.push(te(U,{onClick:this.onRemoveAdminPermission.bind(this,e)},$("Remove admin permissions"))):s.push(te(U,{onClick:this.onGiveAdminPermission.bind(this,e)},$("Give admin permissions"))))),te(G,{position:G.POSITIONS.BOTTOM_LEFT,targetButton:t,items:s,verticalDisplacement:8})},removeUserButton:function(e){return e.user_id!==this.props.viewer.work_user.id&&this.props.canManageTeamMembership?ne.a({className:"remove-user-button",onClick:this.onRemoveMember.bind(this,e)},ne.img({src:"/static/images/x-vflYKfRuL.png"})):""},componentWillMount:function(){return this.columnTypes=ee(this.columnTypes,this)},componentDidMount:function(){return this.props.openInviteModal?this.showInviteModal(this.props.inviteMemberEmails):this.props.openSettingsModal?this.showSettingsModal():"NONE"!==this.props.onboardingModalVariant?this.showUploadModal():this.props.openInviteAndSettingsModal?this.showInviteAndSettingsModal():this.props.openSuggestMembersModal?this.showSuggestMembersModal():void 0},showUploadModal:function(){return this.refs["upload-manager"].showIntroModal()},renderMemberTable:function(){var e,t,s;return e=this.props.showCdmMveUi?[120,140]:[90,170],t=e[0],s=e[1],te(g,{ref:"members",columns:this.props.isLimitedTeam?[this.columnTypes.displayName(390),this.columnTypes.userType(s),this.columnTypes.storageUsed(t),this.columnTypes.approveUser(98),this.columnTypes.adminManagement(50)]:[this.columnTypes.displayName(400),this.columnTypes.userType(200),this.columnTypes.joinedDate(200)],initialData:{rows:this.props.members,total:this.props.total},initialSortColumn:1,emptyMessage:$("No members here"),rowsPerPage:20,classes:{"grey-style":!0},onRequestData:function(e){return function(t,s){return i.WebRequest({url:"/team/manage/list",data:{offset:t.offset,limit:t.limit,sort_column:t.sortColumn,sort_direction:t.sortDir},success:function(t){return t=JSON.parse(t),s(null,{rows:t.members,total:t.total}),e.onTeamMembersUpdated(t.members,t.total,t.num_join_requests)}})}}(this)})},onRemoveMember:function(e){return e.user_id===this.props.viewer.work_user.id?V.showInstance(te(H,{teamName:this.props.teamName})):e.join_request_status===j.PENDING?i.WebRequest({url:"/team/join_request/reject",data:{user_id:e.user_id},success:function(e){return function(){return o.success($("Membership request removed.")),e.refs.members.forceRefresh()}}(this)}):V.showInstance(te(Q,{teamName:this.props.teamName,showUpsellVariant:this.props.showUpsellVariant,user:e,onRemoved:function(e){return function(){return s.reload()}}(this)}))},onGiveAdminPermission:function(e){return V.showInstance(te(B,{targetUser:e,teamId:this.props.viewer.team_id,onSuccess:function(){return s.reload()}}))},onRemoveAdminPermission:function(e){var t;return this.props.viewerIsSoleAdmin?V.showInstance(te(J)):(t=this.props.viewer.work_user.id===e.user_id,V.showInstance(te(z,{targetUser:e,teamId:this.props.viewer.team_id,removingOwnPermissions:t,onSuccess:function(){return s.reload()}})))},onApproveRequest:function(e){return this.shouldShowMaxTeamSizeModal()?void this.showMaxTeamSizeModal():i.WebRequest({url:"/team/join_request/approve",data:{user_id:e.user_id},success:function(e){return function(){return o.success($("Membership approved.")),e.refs.members.forceRefresh()}}(this)})},onInviteClicked:function(){return K.log("clicked_invite_members_cta",{},null,null,!1,K.LOG_CATEGORY.TEAM_INFO),this.shouldShowMaxTeamSizeModal()?(this.props.canHaveLimitedAdminSettings||i.WebRequest({url:"/team/notify_admins_member_attempted_invite"}),this.showMaxTeamSizeModal()):this.showInviteModal()},onSuggestMembersClicked:function(){return K.log("clicked_suggest_members_cta"),this.showSuggestMembersModal()},onUpdateSettingsClicked:function(){return this.showSettingsModal()},showMaxTeamSizeModal:function(){var e;return e={team_id:this.props.viewer.team_id,member_type:this.props.canHaveLimitedAdminSettings?"admin":"non-admin",max_size:this.props.teamMembersLimit},K.log("teams_seen_size_upsell",e,null,this.props.viewer.work_user.id),V.showInstance(te(P,{showAdminVersion:this.props.canHaveLimitedAdminSettings,teamMembersLimit:this.props.teamMembersLimit,contacts:this.state.visibleMembers.filter(function(e){return null!=e.team_join_state})}))},showInviteModal:function(e){var t;return null==e&&(e=[]),this.props.isLimitedTeam?V.showInstance(te(T,{onInvited:function(e){return function(){return e.refs.members.forceRefresh()}}(this),populatedContacts:e.map(function(e){return new q({type:m.EMAIL,email:e})}),memberInviteLimit:this.props.enableMaxSizeExperiment?this.numRemainingInvites():null,maxTeamSize:this.props.teamMembersLimit})):(t={},e.length>0&&btoa?t.invite_emails=btoa(e.join(",")):t.show_invite_members=1,s.redirect(a({path:"/team/admin/members",query:t})))},showSettingsModal:function(){return V.showInstance(te(N,{canChangeTeamName:this.props.canChangeTeamName,canDeleteTeam:this.props.canDeleteTeam,canSetTeamRequestMembershipPolicy:this.props.canSetTeamRequestMembershipPolicy,canChangeNotesLinkPolicy:this.props.canSetNotesLinkPolicy,teamDomain:this.props.teamDomain,teamId:this.props.viewer.team_id,initialTeamName:this.props.teamName,initialTeamFullName:this.props.teamFullName,initialTeamRequestMembershipPolicy:this.props.teamRequestMembershipPolicy,initialNotesLinkPolicy:this.props.notesLinkPolicy}))},showSuggestMembersModal:function(){return V.showInstance(te(A))},showInviteAndSettingsModal:function(){return V.showInstance(te(M,{initialTeamRequestMembershipPolicy:this.props.teamRequestMembershipPolicy,canSetTeamRequestMembershipPolicy:this.props.canSetTeamRequestMembershipPolicy,memberInviteLimit:this.props.enableMaxSizeExperiment?this.numRemainingInvites():null,maxTeamSize:this.props.teamMembersLimit,onInvited:function(e){return function(){return e.refs.members.forceRefresh()}}(this),onDismissCompleted:this.onInviteAndSettingsModalDismissed,suggested_contacts:this.props.suggestedMembers.map(function(e){return new q({dbx_account_id:e.avatar_url&&e.id,type:m.EMAIL,name:e.display_name,email:e.email,photo_url:e.avatar_url})})}))},onInviteAndSettingsModalDismissed:function(e){return e?s.redirect("/team"):this.showAccountPairSuggestModal()},showAccountPairSuggestModal:function(){return this.props.pendingPersonalEmail?V.showInstance(te(k,{suggested_email:this.props.pendingPersonalEmail,current_email:this.props.viewer.work_user.email,cont:"/team"})):void 0},onTeamMembersUpdated:function(e,t,s){return this.setState({totalMembersListLength:t,numJoinRequests:s,visibleMembers:e}),this.shouldShowMaxTeamSizeModal()?this.showMaxTeamSizeModal():void 0},shouldShowMaxTeamSizeModal:function(){return this.props.enableMaxSizeExperiment&&this.numRemainingInvites()<=0},numRemainingInvites:function(){return this.props.teamMembersLimit-(this.state.totalMembersListLength-this.state.numJoinRequests)},render:function(){return ne.div({className:"members-page"},ne.div({className:"page-heading-buttons"},this.props.canInviteMembers?ne.button({className:"button-primary action-button invite-button",onClick:this.onInviteClicked},$("Invite members")):this.props.canSuggestMembers?ne.button({className:"button-primary action-button",onClick:this.onSuggestMembersClicked},$("Suggest team members")):void 0,this.props.hasSettingsDialog?ne.button({className:"button-tertiary action-button settings-button",onClick:this.onUpdateSettingsClicked},$("Settings")):void 0,this.props.canAccessAdminConsole?ne.button({className:"button-tertiary action-button",onClick:function(){return s.redirect("/team/admin/members")}},$("Manage")):void 0),ne.div({className:"page-description"},$("All your %(team_name)s team members.").format({team_name:this.props.teamName})),this.renderMemberTable(),ne.div({className:"upload-manager"},te(W,{ref:"upload-manager",path:this.props.teamFolderPathName,initialOnboardingState:this.props.adminOnboardingState,installPageInformation:this.props.installPageInformation,showDesktopClientInstallModal:!this.props.hasSeenClientInstallUi,modalVariant:this.props.onboardingModalVariant})))}}),{TeamPage:Y}})}.call(this);
//# sourceMappingURL=pkg-aj.min.js-vflWB3PLP.map